<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="Packaging" />
<meta property="og:type" content="website" />
<meta property="og:url" content="packaging.html" />
<meta property="og:site_name" content="Python for Scientific Computing" />
<meta property="og:description" content="Organizing Python projects: Python projects often start as a single script or Jupyter notebook but they can grow out of a single file. In the Scripts episode we have also learned how to import func..." />
<meta name="description" content="Organizing Python projects: Python projects often start as a single script or Jupyter notebook but they can grow out of a single file. In the Scripts episode we have also learned how to import func..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Packaging &mdash; Python for Scientific Computing  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/sphinx_lesson.css" type="text/css" />
      <link rel="stylesheet" href="_static/sphinx_rtd_theme_ext_color_contrast.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="_static/logo-hexagons-02-compact.svg.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/minipres.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Software installation" href="installation.html" />
    <link rel="prev" title="Binder" href="binder.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Python for Scientific Computing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="python.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy-advanced.html">Advanced NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-visualization.html">Data visualization with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-formats.html">Data formats with Pandas and Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipy.html">SciPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Library ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Parallel programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependency management</a></li>
<li class="toctree-l1"><a class="reference internal" href="binder.html">Binder</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Packaging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#organizing-python-projects">Organizing Python projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-a-local-pip-install">Testing a local pip install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercises-1">Exercises 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sharing-packages-via-pypi">Sharing packages via PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tools-that-simplify-sharing-via-pypi">Tools that simplify sharing via PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-conda-package-and-share-it">Building a conda package and share it</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-a-python-package-with-conda-skeleton-pypi">Building a python package with conda skeleton pypi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#publishing-a-python-package">Publishing a python package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Software installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-reference.html">Quick reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">List of exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Instructor’s guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python for Scientific Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Packaging</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/AaltoSciComp/python-for-scicomp/blob/master/content/packaging.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="packaging">
<h1>Packaging<a class="headerlink" href="#packaging" title="Permalink to this heading"></a></h1>
<div class="admonition-questions questions admonition" id="questions-0">
<p class="admonition-title">Questions</p>
<ul class="simple">
<li><p>How to organize Python projects larger than one script?</p></li>
<li><p>What is a good file and folder structure for Python projects?</p></li>
<li><p>How can you make your Python functions most usable by your collaborators?</p></li>
<li><p>How to prepare your code to make a Python package?</p></li>
<li><p>How to publish your Python package?</p></li>
</ul>
</div>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn to identify the components of a Python package</p></li>
<li><p>Learn to create a Python package</p></li>
<li><p>Learn to publish a Python package</p></li>
</ul>
</div>
<section id="organizing-python-projects">
<h2>Organizing Python projects<a class="headerlink" href="#organizing-python-projects" title="Permalink to this heading"></a></h2>
<p>Python projects often start as a single script or Jupyter notebook but
they can grow out of a single file.</p>
<p>In the <a class="reference internal" href="scripts.html#scripts"><span class="std std-ref">Scripts</span></a> episode we have also learned how to import functions
and objects from other Python files (modules). Now we will take it a step further.</p>
<p><strong>Recommendations</strong>:</p>
<ul class="simple">
<li><p>Collect related functions into modules (files).</p></li>
<li><p>Collect related modules into packages (we will show how).</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">LICENSE</span></code> file to your code
see <a class="reference external" href="https://github.com/coderefinery/social-coding/blob/main/licensing-and-cakes.md">Software Licensing and Open source explained with cakes</a>)</p></li>
<li><p>Write a <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file describing what the code does and how to use it.</p></li>
<li><p>It is also recommended to <a class="reference external" href="https://coderefinery.github.io/documentation/">document your package</a>.</p></li>
<li><p>When the project grows, you might need <a class="reference external" href="https://coderefinery.github.io/testing/">automated testing</a>.</p></li>
</ul>
<p>To have a concrete example but still simple example, we will create a project
consisting of 3 functions, each in its own file. We can then imagine that each
file would contain many more functions. To make it more interesting,
one of these functions will depend on an external library: <code class="docutils literal notranslate"><span class="pre">scipy</span></code>.</p>
<p>These are the 3 files:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">adding.py</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">subtracting.py</span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">integrating.py</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>


<span class="k">def</span> <span class="nf">integral</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will add a fourth file:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">__init__.py</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example calculator package.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.adding</span> <span class="kn">import</span> <span class="n">add</span>
<span class="kn">from</span> <span class="nn">.subtracting</span> <span class="kn">import</span> <span class="n">subtract</span>
<span class="kn">from</span> <span class="nn">.integrating</span> <span class="kn">import</span> <span class="n">integral</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.1.0&quot;</span>
</pre></div>
</div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file will be the interface of our package/library.
It also holds the package docstring and the version string.
Note how it imports functions from the various modules using <em>relative imports</em>
(with the dot).</p>
<p>This is how we will arrange the files in the project folder/repository:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>project-folder
├── calculator
<span class="hll">│   ├── adding.py
</span><span class="hll">│   ├── __init__.py
</span><span class="hll">│   ├── integrating.py
</span><span class="hll">│   └── subtracting.py
</span>├── LICENSE
└── README.md
</pre></div>
</div>
<p>Now we are ready to test the package. For this we need to be in the “root”
folder, what we have called the <em>project-folder</em>.  We also need to have
<code class="docutils literal notranslate"><span class="pre">scipy</span></code> available in our environment:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">calculator</span> <span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">subtract</span><span class="p">,</span> <span class="n">integral</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<p>The package is not yet pip-installable, though. We will make this possible in
the next section.</p>
</section>
<section id="testing-a-local-pip-install">
<h2>Testing a local pip install<a class="headerlink" href="#testing-a-local-pip-install" title="Permalink to this heading"></a></h2>
<p>To make our example package pip-installable we need to add one more file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>project-folder
├── calculator
│   ├── adding.py
│   ├── __init__.py
│   ├── integrating.py
│   └── subtracting.py
├── LICENSE
├── README.md
<span class="hll">└── setup.py
</span></pre></div>
</div>
<p>This is how <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> looks:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">setup.py</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">setuptools</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;README.md&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">long_description</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">setuptools</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
    <span class="c1"># adapt &quot;myname&quot; to something unique</span>
    <span class="c1"># if you want to test the upload to test-PyPI</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;calculator-myname&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s2">&quot;Firstname Lastname&quot;</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s2">&quot;firstname.lastname@example.org&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A small example package&quot;</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">long_description</span><span class="p">,</span>
    <span class="n">long_description_content_type</span><span class="o">=</span><span class="s2">&quot;text/markdown&quot;</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://example.org&quot;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">setuptools</span><span class="o">.</span><span class="n">find_packages</span><span class="p">(),</span>
<span class="hll">    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
</span><span class="hll">        <span class="s2">&quot;scipy&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">],</span>
</span>    <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Programming Language :: Python :: 3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;License :: OSI Approved :: MIT License&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Operating System :: OS Independent&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">python_requires</span><span class="o">=</span><span class="s1">&#39;&gt;=3.6&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note how our package requires <code class="docutils literal notranslate"><span class="pre">scipy</span></code> and we decided to not pin the version
here (see <a class="reference internal" href="dependencies.html#version-pinning"><span class="std std-ref">Version pinning for package creators</span></a>).</p>
<p>Now we have all the building blocks to test a local pip install. This is a good
test before trying to upload a package to PyPI or test-PyPI
(see <a class="reference internal" href="dependencies.html#pypi"><span class="std std-ref">PyPI (The Python Package Index) and (Ana)conda</span></a>)</p>
</section>
<section id="exercises-1">
<h2>Exercises 1<a class="headerlink" href="#exercises-1" title="Permalink to this heading"></a></h2>
<div class="admonition-packaging-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Packaging-1</p>
<p>To test a local pip install:</p>
<ul class="simple">
<li><p>Create a new folder outside of our example project</p></li>
<li><p>Create a new virtual environment (<a class="reference internal" href="dependencies.html#dependency-management"><span class="std std-ref">Dependency management</span></a>)</p></li>
<li><p>Install the example package from the project folder
into the new environment: <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">/path/to/project-folder/</span></code></p></li>
<li><p>Test the local installation:</p></li>
</ul>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">calculator</span> <span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">subtract</span><span class="p">,</span> <span class="n">integral</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="sharing-packages-via-pypi">
<h2>Sharing packages via PyPI<a class="headerlink" href="#sharing-packages-via-pypi" title="Permalink to this heading"></a></h2>
<p>Once we are able to pip-install the example package locally, we are ready for
upload.</p>
<p>We exercise by uploading to <a class="reference external" href="https://test.pypi.org/">test-PyPI</a>, not the
real <a class="reference external" href="https://pypi.org/">PyPI</a>, so that if we mess things up, nothing bad
happens.</p>
<p>We need two more things:</p>
<ul class="simple">
<li><p>We will do this using <a class="reference external" href="https://twine.readthedocs.io/">Twine</a> so you need
to pip install that, too.</p></li>
<li><p>You need an account on <a class="reference external" href="https://test.pypi.org/">test-PyPI</a>.</p></li>
</ul>
<p>Let’s try it out. First we create the distribution package:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python setup.py sdist
</pre></div>
</div>
<p>We need twine:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install twine
</pre></div>
</div>
<p>And use twine to upload the distribution files to test-PyPI:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>twine upload -r testpypi dist/*

<span class="go">Uploading distributions to https://test.pypi.org/legacy/</span>
<span class="go">Enter your username:</span>
<span class="go">Enter your password:</span>
</pre></div>
</div>
<p>Once this is done, create yet another virtual environment and try to install from test-PyPI (adapt “myname”):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install -i https://test.pypi.org/simple/ calculator-myname
</pre></div>
</div>
</section>
<section id="tools-that-simplify-sharing-via-pypi">
<h2>Tools that simplify sharing via PyPI<a class="headerlink" href="#tools-that-simplify-sharing-via-pypi" title="Permalink to this heading"></a></h2>
<p>The solution that we have used to create the example package (using
<code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and <code class="docutils literal notranslate"><span class="pre">twine</span></code>) is not the only approach. There are many ways to
achieve this and we avoided going into too many details and comparisons to not
confuse too much. If you web-search this, you will also see that recently the
trend goes towards using <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> as more general alternative to
<code class="docutils literal notranslate"><span class="pre">setup.py</span></code>.</p>
<p>There are at least two tools which try to make the packaging and PyPI interaction easier:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://python-poetry.org/">Poetry</a></p></li>
<li><p><a class="reference external" href="https://flit.readthedocs.io/">Flit</a></p></li>
</ul>
</section>
<section id="building-a-conda-package-and-share-it">
<h2>Building a conda package and share it<a class="headerlink" href="#building-a-conda-package-and-share-it" title="Permalink to this heading"></a></h2>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<p>Most people will watch and observe this, due to speed which we will
move.</p>
</div>
<div class="admonition-prerequisites callout admonition" id="callout-0">
<p class="admonition-title">Prerequisites</p>
<p>To create a conda package, <cite>conda-build</cite> package is required. You may install it with <strong>Anaconda Navigator</strong> or from the command line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda install conda-build
</pre></div>
</div>
</div>
<p>The simplest way for creating a conda package for your python script is to
first publish it in <a class="reference external" href="https://pypi.org/">PyPI</a> following the steps explained
above.</p>
<section id="building-a-python-package-with-conda-skeleton-pypi">
<h3>Building a python package with conda skeleton pypi<a class="headerlink" href="#building-a-python-package-with-conda-skeleton-pypi" title="Permalink to this heading"></a></h3>
<p>Once build, the conda package can be installed locally. For this example, we
will use <a class="reference external" href="https://pypi.org/project/runtest/">runtest</a>.  <a class="reference external" href="https://github.com/bast/runtest">runtest</a> is a numerically tolerant end-to-end test
library for research software.</p>
<ol class="arabic">
<li><p>Create pypi skeleton:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda skeleton pypi runtest
</pre></div>
</div>
<p>The command above will create a new folder called <cite>runtest</cite> containing a file <cite>meta.yaml</cite>, the conda recipe for <cite>runtest</cite>.</p>
</li>
<li><p>Edit <cite>meta.yaml</cite> and update requirements:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">requirements</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flit</span><span class="w"></span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flit</span><span class="w"></span>
</pre></div>
</div>
<p>In the requirements above, we specified what is required for the <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/resources/define-metadata.html#host">host</a> and for <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/resources/define-metadata.html#run">running</a>  the package.</p>
<div class="admonition-remark callout admonition" id="callout-1">
<p class="admonition-title">Remark</p>
<p>For pure python recipes, this is all you need for building a python package with conda.
If your package needs to be built (for instance compilation), you would need additional files e.g. <cite>build.sh</cite> (to build on Linux/Mac-OSX) and <cite>bld.bat</cite> (to build on Windows systems). You can also add test scripts for testing your package. See <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/user-guide/tutorials/build-pkgs.html#writing-the-build-script-files-build-sh-and-bld-bat">documentation</a></p>
</div>
</li>
<li><p>Build your package with conda</p>
<p>Your package is now ready to be build with conda:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda-build runtest
</pre></div>
</div>
<div class="admonition-conda-package-location callout admonition" id="callout-2">
<p class="admonition-title">Conda package location</p>
<p>Look at the messages produced while building. The location of the local conda package is given (search for <cite>anaconda upload</cite>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">~/anaconda3/conda-bld/win-64/runtest-2.2.1-py38_0.tar.bz2</span>
</pre></div>
</div>
<p>The prefix <cite>~/anaconda3/</cite> may be different on your machine and depending on your operating system (Linux, Mac-OSX or Windows) the sub-folder <cite>win-64</cite> differs too (for instance <cite>linux-64</cite> on Linux machines).</p>
<p>The conda package we have created is specific to your platform (here <cite>win-64</cite>). It can be converted to other platforms using <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/user-guide/tutorials/build-pkgs.html#converting-a-package-for-use-on-all-platforms">conda convert</a>.</p>
</div>
</li>
<li><p>Check within new environment</p>
<p>It is not necessary to create a new conda environment to install it but as explained in previous episode, it is good practice to have isolated environments.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda create -n local-runtest --use-local runtest
</pre></div>
</div>
<p>We can then check <cite>runtest</cite> has been successfully installed in <cite>local-runtest</cite> conda environment. Open a new Terminal with <cite>local-runtest</cite> environment (either from the command line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda activate local-runtest
</pre></div>
</div>
<p>or via <strong>Anaconda Navigator</strong> (Open Terminal), import runtest and
check its version:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">runtest</span>
<span class="nb">print</span><span class="p">(</span><span class="n">runtest</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition-building-a-conda-package-from-scratch callout admonition" id="callout-3">
<p class="admonition-title">Building a conda package from scratch</p>
<p>It is possible to build a conda package from scratch without using conda skeleton. We recommend you to check the <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/user-guide/tutorials/build-pkgs.html">conda-build documentation</a> for more information.</p>
</div>
<p>To be able to share and install your local conda package anywhere (on other platforms), you would need to upload it to a <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html">conda channel</a> (see below).</p>
</section>
<section id="publishing-a-python-package">
<h3>Publishing a python package<a class="headerlink" href="#publishing-a-python-package" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Upload your package to <em>Anaconda.org</em>: see instructions <a class="reference external" href="https://docs.conda.io/projects/conda-build/en/latest/user-guide/tutorials/build-pkgs-skeleton.html#optional-uploading-packages-to-anaconda-org">here</a>.
Please note that you will have to create an account on Anaconda.</p></li>
<li><p>Upload your package to <a class="reference external" href="https://conda-forge.org/">conda-forge</a>:
conda-forge is a conda channel: it contains community-led collection of
recipes, build infrastructure and distributions for the conda package
manager. Anyone can public conda packages to conda-forge if certain
<a class="reference external" href="https://conda-forge.org/docs/">guidelines</a> are respected.</p></li>
<li><p>Upload your package to <a class="reference external" href="https://bioconda.github.io/">bioconda</a>: bioconda is
a very popular channel for the conda package manager specializing in
bioinformatics software. As for conda-forge, you need to follow their
<a class="reference external" href="https://bioconda.github.io/contributor/guidelines.html">guidelines</a> when
building conda recipes.</p></li>
</ul>
<p>You can also <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/create-custom-channels.html">create your own conda channel</a>
for publishing your packages.</p>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Organize your code for publishing</p></li>
<li><p>Pypi</p></li>
<li><p>conda</p></li>
</ul>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="binder.html" class="btn btn-neutral float-left" title="Binder" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installation.html" class="btn btn-neutral float-right" title="Software installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>