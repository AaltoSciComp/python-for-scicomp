

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="List of exercises" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://aaltoscicomp.github.io/python-for-scicomp/exercises/" />
<meta property="og:site_name" content="Python for Scientific Computing" />
<meta property="og:description" content="Full list: This is a list of all exercises and solutions in this lesson, mainly as a reference for helpers and instructors. This list is automatically generated from all of the other pages in the l..." />
<meta name="description" content="Full list: This is a list of all exercises and solutions in this lesson, mainly as a reference for helpers and instructors. This list is automatically generated from all of the other pages in the l..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>List of exercises &mdash; Python for Scientific Computing  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />

  
    <link rel="shortcut icon" href="../_static/logo-hexagons-02-compact.svg.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=35a8b989"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = "div.highlight"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = "div.highlight"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script src="../_static/tabs.js?v=3030b3cb"></script>
      <script data-domain="aaltoscicomp.github.io/python-for-scicomp" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Instructor’s guide" href="../guide/" />
    <link rel="prev" title="Quick reference" href="../quick-reference/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Python for Scientific Computing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numpy/">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numpy-advanced/">Advanced NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xarray/">Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting-matplotlib/">Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting-vega-altair/">Plotting with Vega-Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="../work-with-data/">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiling/">Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../productivity/">Productivity tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scipy/">SciPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libraries/">Library ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/">Dependency management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../binder/">Binder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/">Parallel programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packaging/">Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-apis/">Web APIs with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cython/">Extending Python with Cython</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/">Software installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Quick reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">List of exercises</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#full-list">Full list</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/">Instructor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-formats/">In depth analysis of some selected file formats</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Python for Scientific Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">List of exercises</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/AaltoSciComp/python-for-scicomp/blob/master/content/exercises.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="list-of-exercises">
<h1>List of exercises<a class="headerlink" href="#list-of-exercises" title="Link to this heading"></a></h1>
<section id="full-list">
<h2>Full list<a class="headerlink" href="#full-list" title="Link to this heading"></a></h2>
<p>This is a list of all exercises and solutions in this lesson, mainly
as a reference for helpers and instructors.  This list is
automatically generated from all of the other pages in the lesson.
Any single teaching event will probably cover only a subset of these,
depending on their interests.</p>
<section id="jupyter">
<h3>Jupyter<a class="headerlink" href="#jupyter" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../jupyter/#exercise-0">In jupyter.ipynb:</a></p>
<div class="admonition-exercises-jupyter-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercises: Jupyter-1</p>
<p>If you aren’t set up with JupyterLab yet or these things don’t work, use this time to see the <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/installation/">installation instructions</a> and ask us any questions you may have.</p>
<ol class="arabic simple">
<li><p>Start Jupyter in the directory you want to use for this course.</p>
<ul class="simple">
<li><p>If you are using Miniforge from the command line, you can navigate with <code class="docutils literal notranslate"><span class="pre">cd</span></code> to a directory of your choice.</p></li>
<li><p>If you are starting from the Anaconda Navigator, change to the directory you want to use.</p></li>
</ul>
</li>
<li><p>Create a Python 3 notebook file.  Save it.  In the next section, you will add stuff to it.</p></li>
<li><p>(optional, but will be done in future lessons) Explore the file browser, try making some non-notebook text/py/md files and get used to that.</p></li>
<li><p>(optional, advanced) Look at the notebook file in a text
editor.  How does it work?</p></li>
</ol>
<p>If everything works for you, this will end very quickly.  You can begin reading the next sections independently.</p>
</div>
<p><a class="reference external" href="../jupyter/#exercise-1">In jupyter.ipynb:</a></p>
<div class="admonition-exercises-jupyter-2 exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercises: Jupyter-2</p>
<ol class="arabic simple">
<li><p>Run some trivial code, such as <code class="docutils literal notranslate"><span class="pre">print(1)</span></code>.</p></li>
<li><p>Run some slightly less trivial code, like print out the first
ten <a class="reference external" href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a>.</p></li>
<li><p>Make a Markdown cell above your code cell and give it a title and some description of your function.  Use the <a class="reference external" href="https://commonmark.org/help/">reference</a> to add a heading, bullet list, and some (bold, italic, or inline code)</p></li>
<li><p>Use the <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">%%timeit</a> magic function to time your Fibonacci
function.</p></li>
<li><p>Again using <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code>, figure out the fastest way to sum the
numbers 0 to 1000000.</p></li>
<li><p>Once you are done, close your notebooks and other tabs you don’t need.  Check the running sessions (hint: thin left sidebar) and shut down these kernels.</p></li>
</ol>
</div>
<p><a class="reference external" href="../jupyter/#solution-0">In jupyter.ipynb:</a></p>
<div class="admonition-solutions-jupyter-2 solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solutions: Jupyter-2</p>
<ol class="arabic">
<li><p>–</p></li>
<li><p>Simple fibonacci code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>
</pre></div>
</div>
</li>
<li><p>Markdown description</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gh"># Fibonacci</span>
<span class="k">*</span><span class="w"> </span>Start with two variables <span class="sb">`a`</span> and <span class="sb">`b`</span>
<span class="k">*</span><span class="w"> </span>Repeat 10 times
<span class="w">    </span><span class="k">*</span><span class="w"> </span>Print old <span class="sb">`a`</span>, then increment both
<span class="k">*</span><span class="w"> </span>Makes use of the Python <span class="ge">*tuple assignment*</span>: <span class="sb">`a, b = new_a, new_b`</span>
</pre></div>
</div>
</li>
<li><p>In this case, the print() statements get out of hand, so we comment that out.  In general, writing output usually takes a lot of time reletive to the computation, so we don’t want to time that (unless output is the main point of the code, then we do have to time it!</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="o">%%timeit</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1">#print(a)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>395 ns ± 10.2 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</pre></div>
</div>
</li>
<li><p>–</p></li>
<li><p>–</p></li>
</ol>
</div>
<p><a class="reference external" href="../jupyter/#exercise-2">In jupyter.ipynb:</a></p>
<div class="admonition-exercises-jupyter-3 exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercises: Jupyter-3</p>
<p>(optional) Discuss the following in groups:</p>
<ol class="arabic simple">
<li><p>Have any of you used Jupyter in a way that became impossible to
maintain: too many files, code all spread out, not able to find
your code and run it in the right order.  How did you solve that?</p></li>
<li><p>On the other hand, what are your successes with Jupyter?</p></li>
<li><p>How can you prevent these problems by better development strategies?</p></li>
</ol>
</div>
</section>
<section id="numpy">
<h3>NumPy<a class="headerlink" href="#numpy" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../numpy/#exercise-0">In numpy.rst:</a></p>
<div class="admonition-exercises-numpy-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercises: Numpy-1</p>
<ol class="arabic simple">
<li><p><strong>Datatypes</strong> Try out <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.arange(10)</span></code></a> and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.linspace(0,9,10)</span></code></a>, what is the difference? Can you adjust one to do the same as the other?</p></li>
<li><p><strong>Datatypes</strong> Create a 3x2 array of random float numbers (check <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.random.html#numpy.random.random" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.random.random()</span></code></a>) between 0 and 1. Now change the arrays datatype to int (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.astype.html#numpy.ndarray.astype" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array.astype</span></code></a>). How does the array look like?</p></li>
<li><p><strong>Reshape</strong> Create a 3x2 array of random integer numbers between 0 and 10. Change the shape of the array (check <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.reshape.html#numpy.ndarray.reshape" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array.reshape</span></code></a>) in any way possible. What is not possible?</p></li>
<li><p><strong>NumPyI/O</strong> Save above array to .npy file (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.save.html#numpy.save" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.save()</span></code></a>) and read it in again.</p></li>
</ol>
</div>
<p><a class="reference external" href="../numpy/#solution-0">In numpy.rst:</a></p>
<div class="admonition-solutions-numpy-1 solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solutions: Numpy-1</p>
<ol class="arabic simple">
<li><p><strong>Datatypes</strong></p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">np.arange(10)</span></code> results in <code class="docutils literal notranslate"><span class="pre">array([0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9])</span></code> with dtype <strong>int64</strong>,</p></li>
<li><p>while <code class="docutils literal notranslate"><span class="pre">np.linspace(0,9,10)</span></code> results in <code class="docutils literal notranslate"><span class="pre">array([0.,</span> <span class="pre">1.,</span> <span class="pre">2.,</span> <span class="pre">3.,</span> <span class="pre">4.,</span> <span class="pre">5.,</span> <span class="pre">6.,</span> <span class="pre">7.,</span> <span class="pre">8.,</span> <span class="pre">9.])</span></code> with dtype <strong>float64</strong>.</p></li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code> and <code class="docutils literal notranslate"><span class="pre">np.arange</span></code> take dtype as an argument and can be adjusted to match each other in that way.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Datatypes</strong> eg <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">np.random.random((3,2))</span></code>. <code class="docutils literal notranslate"><span class="pre">a.astype('int')</span></code> results in an all zero array, not as maybe expected the rounded int (all numbers [0, 1) are cast to 0).</p></li>
<li><p><strong>Reshape</strong> eg <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">np.random.randint(0,10,(3,2))</span></code>.</p></li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">b.reshape((6,1))</span></code> and <code class="docutils literal notranslate"><span class="pre">b.reshape((2,3))</span></code> possible.</p>
<p>It is not possible to reshape to shapes using more or less elements than <code class="docutils literal notranslate"><span class="pre">b.size</span> <span class="pre">=</span> <span class="pre">6</span></code>, so for example <code class="docutils literal notranslate"><span class="pre">b.reshape((12,1))</span></code> gives an error.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><strong>NumPyI/O</strong> <code class="docutils literal notranslate"><span class="pre">np.save('x.npy',</span> <span class="pre">b)</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.load('x.npy')</span></code></p></li>
</ol>
</div>
<p><a class="reference external" href="../numpy/#exercise-1">In numpy.rst:</a></p>
<div class="admonition-exercises-numpy-2 exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercises: Numpy-2</p>
<p>Create the following arrays:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1-dimensional arrays</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="c1"># TODO: similar to `x`, create another 1-dimensional array with shape (3,)</span>
<span class="c1"># y = np.array(...)</span>

<span class="c1"># 2-dimensional arrays</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="c1"># TODO: similar to `a`, create another 2-dimensional array with shape (2, 2)</span>
<span class="c1"># b = np.array(...)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Matrix multiplication</strong> What is the difference between <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.multiply.html#numpy.multiply" title="(in NumPy v2.3)"><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.multiply</span></code></a> and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dot.html#numpy.dot" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.dot()</span></code></a> ? Try calling these functions
with either <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y</span></code> (1D arrays) or <code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span></code> (2D arrays) as input and observe the behaviour.</p></li>
<li><p><strong>Axis</strong> What is the difference between <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.sum(a,</span> <span class="pre">axis=1)</span></code></a> vs
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.sum(a,</span> <span class="pre">axis=0)</span></code></a> on a two-dimensional array? What if you leave out the axis parameter?</p></li>
</ul>
</div>
<p><a class="reference external" href="../numpy/#solution-1">In numpy.rst:</a></p>
<div class="admonition-solutions-numpy-2 solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solutions: Numpy-2</p>
<ul class="simple">
<li><p><strong>Matrix multiplication</strong> <code class="docutils literal notranslate"><span class="pre">np.multiply</span></code> does elementwise multiplication on two arrays. The function <code class="docutils literal notranslate"><span class="pre">np.dot</span></code> enables:
- <em>dot product</em> and returns a scalar, when both input arrays are 1 dimensional
- <em>matrix multiplication</em> and returns back a 2-dimensional array, when both the input arrays are 2 dimensional
However, <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#64;</span> <span class="pre">b</span></code> is preferred over <code class="docutils literal notranslate"><span class="pre">np.dot(a,</span> <span class="pre">b)</span></code> to express matrix multiplication.</p></li>
<li><p><strong>Axis</strong> <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> does the operation (here: <code class="docutils literal notranslate"><span class="pre">np.sum</span></code>) over each row, while axis=0 does it over each column. If axis is left out, the sum of the full array is given.</p></li>
</ul>
</div>
<p><a class="reference external" href="../numpy/#exercise-2">In numpy.rst:</a></p>
<div class="admonition-exercise-numpy-3 exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise: Numpy-3</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Try out the above code.</p>
<ul class="simple">
<li><p>How does <code class="docutils literal notranslate"><span class="pre">a</span></code> look like before <code class="docutils literal notranslate"><span class="pre">b</span></code> has changed and after?</p></li>
<li><p>How could it be avoided?</p></li>
</ul>
</div>
<p><a class="reference external" href="../numpy/#solution-2">In numpy.rst:</a></p>
<div class="admonition-solution-numpy-3 solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution: Numpy-3</p>
<p><strong>View vs copy</strong>: The change in <code class="docutils literal notranslate"><span class="pre">b</span></code> has also changed the array <code class="docutils literal notranslate"><span class="pre">a</span></code>!
This is because <code class="docutils literal notranslate"><span class="pre">b</span></code> is merely a <em>view</em> or a <em>shallow copy</em> of a part of array <code class="docutils literal notranslate"><span class="pre">a</span></code>.  Both
variables point to the same memory. Hence, if one is changed, the other
one also changes.</p>
<p>In this example, if you need to keep the original array as is, use
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.copy.html#numpy.copy" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.copy(a)</span></code></a> or <code class="docutils literal notranslate"><span class="pre">np.copy(a[:,</span> <span class="pre">0])</span></code>
to create a new <em>deep copy</em> of the whole or a slice of array respectively,
before updating <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>NumPy’s documentation on <a class="reference external" href="https://numpy.org/doc/stable/user/quickstart.html#quickstart-copies-and-views" title="(in NumPy v2.3)"><span>Copies and views</span></a></p>
</div>
</div>
<p><a class="reference external" href="../numpy/#exercise-3">In numpy.rst:</a></p>
<div class="admonition-exercises-numpy-4 exercise important admonition" id="exercise-3">
<p class="admonition-title">Exercises: Numpy-4</p>
<ul class="simple">
<li><p><strong>In-place addition</strong>: Create an array, add it to itself using a
ufunc.</p></li>
<li><p><strong>In-place addition</strong> (advanced): Create an array of
<code class="docutils literal notranslate"><span class="pre">dtype='float'</span></code>, and an array of <code class="docutils literal notranslate"><span class="pre">dtype='int'</span></code>.  Try to use the
int array as the output argument of the first two arrays.</p></li>
<li><p><strong>Output arguments and timing</strong> Repeat the initial <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">**</span>
<span class="pre">2</span></code> example using a ufunc and time it.  Can you make
it even faster using the output argument?</p></li>
</ul>
</div>
<p><a class="reference external" href="../numpy/#solution-3">In numpy.rst:</a></p>
<div class="admonition-solution-numpy-4 solution important dropdown admonition" id="solution-3">
<p class="admonition-title">Solution: Numpy-4</p>
<ul>
<li><p><strong>in-place addition</strong>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                        <span class="c1"># get the memory-ID of x</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>          <span class="c1"># Third argument is output array</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                        <span class="c1"># get the memory-ID of x</span>
                             <span class="c1"># - notice  it is the same</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">np.add()</span></code> writes the result to the output array (<code class="docutils literal notranslate"><span class="pre">out=</span></code>)
<em>and</em> the function returns that same array.</p>
</li>
<li><p><strong>Output arguments and timing</strong> In this case, on my computer, it was
actually slower (this is due to it being such a small array!):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10_000</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10_000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">timeit</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>This is a good example of why you always need to time things
before deciding what is best.</p>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">_</span></code> inside numbers is just for human readability and is
ignored by python.</p>
</li>
</ul>
</div>
<p><a class="reference external" href="../numpy/#exercise-4">In numpy.rst:</a></p>
<div class="admonition-numpy-5 exercise important admonition" id="exercise-4">
<p class="admonition-title">Numpy-5</p>
<p>If you have extra time, try these out.  These are advanced and
optional, and will not be done in most courses.</p>
<ol class="arabic simple">
<li><p>Reverse a vector. Given a vector, reverse it such that the last
element becomes the first, e.g. <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">2,</span> <span class="pre">1]</span></code></p></li>
<li><p>Create a 2D array with zeros on the borders and 1 inside.</p></li>
<li><p>Create a random array with elements [0, 1), then add 10 to all
elements in the range [0.2, 0.7).</p></li>
<li><p>What is <code class="xref py py-func docutils literal notranslate"><span class="pre">np.round(0.5)</span></code>? What is <code class="docutils literal notranslate"><span class="pre">np.round(1.5)</span></code>? Why?</p></li>
<li><p>In addition to <code class="docutils literal notranslate"><span class="pre">np.round</span></code>, explore <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ceil.html#numpy.ceil" title="(in NumPy v2.3)"><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.ceil</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.floor.html#numpy.floor" title="(in NumPy v2.3)"><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.floor</span></code></a>,
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.trunc.html#numpy.trunc" title="(in NumPy v2.3)"><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.trunc</span></code></a>. In particular, take note of how they behave with
negative numbers.</p></li>
<li><p>Recall the identity <span class="math notranslate nohighlight">\(\sin^2(x) + \cos^2(x) = 1\)</span>. Create a
random 4x4 array with values in the range [0, 10). Now test the
equality with <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.equal.html#numpy.equal" title="(in NumPy v2.3)"><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.equal</span></code></a>. What result do you get with
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.allclose.html#numpy.allclose" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.allclose()</span></code></a> instead of <code class="docutils literal notranslate"><span class="pre">np.equal</span></code>?</p></li>
<li><p>Create a 1D array with 10 random elements. Sort it.</p></li>
<li><p>What’s the difference between <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.sort.html#numpy.ndarray.sort" title="(in NumPy v2.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">np_array.sort()</span></code></a> and
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.sort.html#numpy.sort" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">np.sort(np_array)</span></code></a>?</p></li>
<li><p>For the random array in question 8, instead of sorting it, perform
an indirect sort. That is, return the list of indices which would
index the array in sorted order.</p></li>
<li><p>Create a 4x4 array of zeros, and another 4x4 array of ones. Next
combine them into a single 8x4 array with the content of the zeros
array on top and the ones on the bottom.  Finally, do the same,
but create a 4x8 array with the zeros on the left and the ones on
the right.</p></li>
<li><p>NumPy functionality Create two 2D arrays and do matrix multiplication
first manually (for loop), then using the np.dot function. Use %%timeit
to compare execution times. What is happening?</p></li>
</ol>
</div>
<p><a class="reference external" href="../numpy/#solution-4">In numpy.rst:</a></p>
<div class="admonition-solution-numpy-5 solution important dropdown admonition" id="solution-4">
<p class="admonition-title">Solution Numpy-5</p>
<ol class="arabic">
<li><p>One solution is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">a</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>One solution is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">b</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],:]</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>A possible solution is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">0.2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>For values exactly halfway between rounded decimal values, NumPy rounds to the nearest even value.</p></li>
<li><p>Let’s test those functions with few negative and positive values:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [-3. -2. -2. -1. -0.  0.  1.  2.  2.  3.]</span>
<span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [-3. -2. -1. -0. -0.  1.  1.  2.  3.  3.]</span>
<span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [-4. -3. -2. -1. -1.  0.  0.  1.  2.  3.]</span>
<span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [-3. -2. -1. -0. -0.  0.  0.  1.  2.  3.]</span>
</pre></div>
</div>
</li>
<li><p>One solution is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">oo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">s2c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span><span class="n">s2c2</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span><span class="n">s2c2</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Sorting the array itself, without copying it:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>NumPy.sort() returns a sorted copy of an array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.argsort(x)</span></code></p></li>
<li><p>One solution is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="n">o</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="n">o</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Using numpy without numpy functionality (np.dot) in this case, is still slow.</p></li>
</ol>
</div>
</section>
<section id="advanced-numpy">
<h3>Advanced NumPy<a class="headerlink" href="#advanced-numpy" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../numpy-advanced/#exercise-0">In numpy-advanced.rst:</a></p>
<div class="admonition-exercises-numpy-advanced-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercises: Numpy-Advanced-1</p>
<p>Write a Python script that uses NumPy to generate 100 million (100000000)
random numbers and add them all together. Time how long it takes to execute.
Can you beat the C version?</p>
<p>If you are having trouble with this, we recommend completing the
<a class="reference internal" href="../numpy/#numpy"><span class="std std-ref">basic NumPy lesson</span></a> before continuing with this
advanced lesson.  If you are taking a live course - don’t
worry, watch and learn and explore some during the exercises!</p>
</div>
<p><a class="reference external" href="../numpy-advanced/#solution-0">In numpy-advanced.rst:</a></p>
<div class="admonition-solutions-numpy-advanced-1 solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solutions: Numpy-Advanced-1</p>
<p>The script can be implemented like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100_000_000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../numpy-advanced/#exercise-1">In numpy-advanced.rst:</a></p>
<div class="admonition-exercises-numpy-advanced-2 exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercises: Numpy-Advanced-2</p>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> that takes the row and column of an
element in a 2D matrix and produces the appropriate index in an 1D array,
where all the rows are concatenated. See the image above to remind yourself
how each row of the 2D matrix ends up in the 1D array.</p>
<p>The function takes these inputs:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">row</span></code> The row of the requested element in the matrix as integer index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">col</span></code> The column of the requested element in the matrix as integer index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_rows</span></code> The total number of rows of the matrix.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_cols</span></code> The total number of columns of the matrix.</p></li>
</ul>
</div></blockquote>
<p>Here are some examples of input and desired output:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ravel(2,</span> <span class="pre">3,</span> <span class="pre">n_rows=4,</span> <span class="pre">n_cols=4)</span></code> → <code class="docutils literal notranslate"><span class="pre">11</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ravel(2,</span> <span class="pre">3,</span> <span class="pre">n_rows=4,</span> <span class="pre">n_cols=8)</span></code> → <code class="docutils literal notranslate"><span class="pre">19</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ravel(0,</span> <span class="pre">0,</span> <span class="pre">n_rows=1,</span> <span class="pre">n_cols=1)</span></code> → <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ravel(3,</span> <span class="pre">3,</span> <span class="pre">n_rows=4,</span> <span class="pre">n_cols=4)</span></code> → <code class="docutils literal notranslate"><span class="pre">15</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ravel(3_465,</span> <span class="pre">18_923,</span> <span class="pre">n_rows=10_000,</span> <span class="pre">n_cols=20_000)</span></code> → <code class="docutils literal notranslate"><span class="pre">69_318_923</span></code></p></li>
</ul>
</div></blockquote>
</div>
<p><a class="reference external" href="../numpy-advanced/#solution-1">In numpy-advanced.rst:</a></p>
<div class="admonition-solutions-numpy-advanced-2 solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solutions: Numpy-Advanced-2</p>
<p>The function can be implemented like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ravel</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">row</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">col</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../numpy-advanced/#exercise-2">In numpy-advanced.rst:</a></p>
<div class="admonition-exercises-numpy-advanced-3 exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercises: Numpy-Advanced-3</p>
<p>A little known feature of NumPy is the <code class="docutils literal notranslate"><span class="pre">numpy.stride_tricks</span></code> module
that allows you to modify the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.strides.html#numpy.ndarray.strides" title="(in NumPy v2.3)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">strides</span></code></a> attribute directly. Playing
around with this is very educational.</p>
<ol class="arabic">
<li><p>Create your own <code class="docutils literal notranslate"><span class="pre">transpose()</span></code> function that will transpose a 2D matrix
by reversing its <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.shape.html#numpy.ndarray.shape" title="(in NumPy v2.3)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape</span></code></a> and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.strides.html#numpy.ndarray.strides" title="(in NumPy v2.3)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">strides</span></code></a> attributes using
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.lib.stride_tricks.as_strided.html#numpy.lib.stride_tricks.as_strided" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.lib.stride_tricks.as_strided()</span></code></a>.</p></li>
<li><p>Create a (5 ✕ 100 000 000 000) array containing on the first row all
1’s, the second row all 2’s, and so on.  Start with an 1D array
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">np.array([1.,</span> <span class="pre">2.,</span> <span class="pre">3.,</span> <span class="pre">4.,</span> <span class="pre">5.])</span></code>
and modify its <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">strides</span></code> attributes using
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.lib.stride_tricks.as_strided.html#numpy.lib.stride_tricks.as_strided" title="(in NumPy v2.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.lib.stride_tricks.as_strided()</span></code></a> to obtain the desired 2D
matrix:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">]])</span>
</pre></div>
</div>
</li>
</ol>
</div>
<p><a class="reference external" href="../numpy-advanced/#solution-2">In numpy-advanced.rst:</a></p>
<div class="admonition-solutions-numpy-advanced-3 solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solutions: Numpy-Advanced-3</p>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">transpose()</span></code> function can be implemented like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.lib.stride_tricks</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_strided</span>
<span class="k">def</span><span class="w"> </span><span class="nf">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">strides</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Testing the function on a small matrix</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Before transpose:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After transpose:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><ol class="arabic" start="2">
<li><p>By setting one of the <code class="docutils literal notranslate"><span class="pre">.strides</span></code> to <cite>0</cite>, we can repeat a value
infinitely many times without using any additional memory:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.lib.stride_tricks</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_strided</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100_000_000_000</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
</div>
</section>
<section id="pandas">
<h3>Pandas<a class="headerlink" href="#pandas" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../pandas/#exercise-0">In pandas.rst:</a></p>
<div class="admonition-exploring-dataframes exercise important admonition" id="exercise-0">
<p class="admonition-title">Exploring dataframes</p>
<blockquote>
<div><ul class="simple">
<li><p>Have a look at the available methods and attributes using the
<a class="reference external" href="https://pandas.pydata.org/docs/reference/frame.html">API reference</a>
or the autocomplete feature in Jupyter.</p></li>
<li><p>Try out a few methods using the Titanic dataset and have a look at
the docstrings (help pages) of methods that pique your interest</p></li>
<li><p>Compute the mean age of the first 10 passengers by slicing and the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mean.html#pandas.DataFrame.mean" title="(in pandas v2.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.mean()</span></code></a> method</p></li>
<li><p>(Advanced) Using boolean indexing, compute the survival rate
(mean of “Survived” values) among passengers over and under the average age.</p></li>
</ul>
</div></blockquote>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ul>
<li><p>Mean age of the first 10 passengers:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:][</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s2">&quot;Nasser, Mrs. Nicholas (Adele Achem)&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Survival rate among passengers over and under average age:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()][</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()][</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<p><a class="reference external" href="../pandas/#exercise-1">In pandas.rst:</a></p>
<div class="admonition-analyze-the-titanic-passenger-list-dataset exercise important admonition" id="exercise-1">
<p class="admonition-title">Analyze the Titanic passenger list dataset</p>
<blockquote>
<div><p>In the Titanic passenger list dataset,
investigate the family size of the passengers (i.e. the “SibSp” column).</p>
<ul class="simple">
<li><p>What different family sizes exist in the passenger list? Hint: try the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.unique.html#pandas.Series.unique" title="(in pandas v2.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unique()</span></code></a> method</p></li>
<li><p>What are the names of the people in the largest family group?</p></li>
<li><p>(Advanced) Create histograms showing the distribution of family sizes for
passengers split by the fare, i.e. one group of high-fare passengers (where
the fare is above average) and one for low-fare passengers
(Hint: instead of an existing column name, you can give a lambda function
as a parameter to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.hist.html#pandas.DataFrame.hist" title="(in pandas v2.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hist()</span></code></a> to compute a value on the fly. For example
<code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">&quot;Poor&quot;</span> <span class="pre">if</span> <span class="pre">df[&quot;Fare&quot;].loc[x]</span> <span class="pre">&lt;</span> <span class="pre">df[&quot;Fare&quot;].mean()</span> <span class="pre">else</span> <span class="pre">&quot;Rich&quot;</span></code>).</p></li>
</ul>
</div></blockquote>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<ul>
<li><p>Existing family sizes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;SibSp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>We get 8 from above.  There is no <code class="docutils literal notranslate"><span class="pre">Name</span></code> column, since we
made <code class="docutils literal notranslate"><span class="pre">Name</span></code> the index when we loaded the dataframe with
<code class="docutils literal notranslate"><span class="pre">read_csv</span></code>, so we use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.index.html#pandas.DataFrame.index" title="(in pandas v2.3.3)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pandas.DataFrame.index</span></code></a> to get
the names.  So, names of members of largest family(ies):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;SibSp&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</li>
<li><p>Histogram of family size based on fare class:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s2">&quot;SibSp&quot;</span><span class="p">,</span>
             <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;Poor&quot;</span> <span class="k">if</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Fare&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Fare&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;Rich&quot;</span><span class="p">,</span>
             <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<p><a class="reference external" href="../pandas/#exercise-2">In pandas.rst:</a></p>
<div class="admonition-analyze-the-nobel-prize-dataset exercise important admonition" id="exercise-2">
<p class="admonition-title">Analyze the Nobel prize dataset</p>
<blockquote>
<div><ul class="simple">
<li><p>What country has received the largest number of Nobel prizes, and how many?
How many countries are represented in the dataset? Hint: use the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.describe.html#pandas.Series.describe" title="(in pandas v2.3.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">describe</span></code></a> method
on the <code class="docutils literal notranslate"><span class="pre">bornCountryCode</span></code> column.</p></li>
<li><p>Create a histogram of the age when the laureates received their Nobel prizes.
Hint: follow the above steps we performed for the lifespan.</p></li>
<li><p>List all the Nobel laureates from your country.</p></li>
</ul>
<p>Now more advanced steps:</p>
<ul>
<li><p>Now define an array of 4 countries of your choice and extract
only laureates from these countries (you need to look at the
data and find how countries are written, and replace <code class="docutils literal notranslate"><span class="pre">COUNTRY</span></code>
with those strings):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">countries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">COUNTRY1</span><span class="p">,</span> <span class="n">COUNTRY2</span><span class="p">,</span> <span class="n">COUNTRY3</span><span class="p">,</span> <span class="n">COUNTRY4</span><span class="p">])</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">nobel</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;bornCountry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)]</span>
</pre></div>
</div>
</li>
<li><p>Use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html#pandas.DataFrame.groupby" title="(in pandas v2.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">groupby()</span></code></a> to compute how many nobel prizes each country received in
each category. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">size()</span></code> method tells us how many rows, hence nobel
prizes, are in each group:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">nobel</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;bornCountry&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><strong>(Optional)</strong> Create a pivot table to view a spreadsheet like structure, and view it</p>
<blockquote>
<div><ul>
<li><p>First add a column “number” to the nobel dataframe containing 1’s
(to enable the counting below).  We need to make a copy of
<code class="docutils literal notranslate"><span class="pre">subset</span></code>, because right now it is only a view:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p>Then create the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot_table.html#pandas.DataFrame.pivot_table" title="(in pandas v2.3.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pivot_table()</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;bornCountry&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>(Optional)</strong> Install the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> visualization library if you don’t
already have it, and create a heatmap of your table:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><strong>(Optional)</strong> Play around with other nice looking plots:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">subset</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bornCountry&quot;</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="s2">&quot;stick&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">subset</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bornCountry&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_physchem</span> <span class="o">=</span> <span class="n">nobel</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;bornCountry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;physics&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;chemistry&#39;</span><span class="p">])</span>
    <span class="p">)</span>
<span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bornCountry&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">subset_physchem</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;swarm&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;bornCountry&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">subset_physchem</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>Below is solutions for the basic steps, advanced steps are
inline above.</p>
<p>We use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">describe()</span></code> method:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">nobel</span><span class="o">.</span><span class="n">bornCountryCode</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="c1"># count     969</span>
<span class="c1"># unique     82</span>
<span class="c1"># top        US</span>
<span class="c1"># freq      292</span>
</pre></div>
</div>
<p>We see that the US has received the largest number of Nobel prizes,
and 82 countries are represented.</p>
<p>To calculate the age at which laureates receive their prize, we need
to ensure that the “year” and “born” columns are in datetime format:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;born&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;born&quot;</span><span class="p">],</span> <span class="n">errors</span> <span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we add a column with the age at which Nobel prize was received
and plot a histogram:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;age_nobel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;born&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="mi">365</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">nobel</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;age_nobel&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>We can print names of all laureates from a given country, e.g.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">nobel</span><span class="p">[</span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Sweden&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;firstname&quot;</span><span class="p">:</span><span class="s2">&quot;surname&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="xarray">
<h3>Xarray<a class="headerlink" href="#xarray" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../xarray/#exercise-0">In xarray.rst:</a></p>
<div class="admonition-exercises-xarray-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercises: Xarray-1</p>
<p>Download the <code class="docutils literal notranslate"><span class="pre">NARR_19930313_0000.nc</span></code> dataset have a look at all Data variables. Calculate the geopotential height at <code class="docutils literal notranslate"><span class="pre">x=5148.3726</span></code> averaged over <code class="docutils literal notranslate"><span class="pre">y</span></code> and return the median value. You can use the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method to check on the way whether you use the correct dimensions and indices.</p>
</div>
<p><a class="reference external" href="../xarray/#solution-0">In xarray.rst:</a></p>
<div class="admonition-solutions-xarray-1 solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solutions: Xarray-1</p>
<p>One way of calculating this is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pythia_datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">DATASETS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;NARR_19930313_0000.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;Geopotential_height_isobaric&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5148.3726</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="go">&lt;xarray.DataArray &#39;Geopotential_height_isobaric&#39; ()&gt; Size: 4B</span>
<span class="go">array(4395.487, dtype=float32)</span>
<span class="go">Coordinates:</span>
<span class="go">    x        float32 4B 5.148e+03</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../xarray/#exercise-1">In xarray.rst:</a></p>
<div class="admonition-exercises-xarray-2 exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercises: Xarray-2</p>
<p>Let’s change from climate science to finance for this example. Put the stock prices and trading volumes of three companies in one dataset. Create an Xarray Dataset that uses time and company as dimensions and contains two DataArrays: <code class="docutils literal notranslate"><span class="pre">stock_price</span></code> and <code class="docutils literal notranslate"><span class="pre">trading_volume</span></code>. You can download the data as a pandas DataFrame with the following code:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>

<span class="n">AAPL_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">)</span>
<span class="n">GOOGL_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;GOOGL&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">)</span>
<span class="n">MSFT_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;MSFT&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As a last thing, add the currency of the stock prices as an attribute to the Dataset.</p>
</div>
<p><a class="reference external" href="../xarray/#solution-1">In xarray.rst:</a></p>
<div class="admonition-solutions-xarray-2 solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solutions: Xarray-2</p>
<p>We can use a script similar to this one:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;2020-01-01&quot;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;2024-01-01&quot;</span>

<span class="n">AAPL_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
<span class="n">GOOGL_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;GOOGL&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
<span class="n">MSFT_df</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;MSFT&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>


<span class="n">stock_prices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">AAPL_df</span><span class="p">[</span><span class="s2">&quot;Close&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">GOOGL_df</span><span class="p">[</span><span class="s2">&quot;Close&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">MSFT_df</span><span class="p">[</span><span class="s2">&quot;Close&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">trading_volumes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">AAPL_df</span><span class="p">[</span><span class="s2">&quot;Volume&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">GOOGL_df</span><span class="p">[</span><span class="s2">&quot;Volume&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">MSFT_df</span><span class="p">[</span><span class="s2">&quot;Volume&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>


<span class="n">companies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;GOOGL&quot;</span><span class="p">,</span> <span class="s2">&quot;MSFT&quot;</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">AAPL_df</span><span class="o">.</span><span class="n">index</span><span class="p">[:]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;stock_price&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;company&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">stock_prices</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="s2">&quot;trading_volume&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;company&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">trading_volumes</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="p">},</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span> <span class="s2">&quot;company&quot;</span><span class="p">:</span> <span class="n">companies</span><span class="p">},</span>
    <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="plotting-with-matplotlib">
<h3>Plotting with Matplotlib<a class="headerlink" href="#plotting-with-matplotlib" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../plotting-matplotlib/#exercise-0">In plotting-matplotlib.md:</a></p>
<div class="admonition-exercise-matplotlib-1-extend-the-previous-example-15-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Matplotlib-1: extend the previous example (15 min)</p>
<ul>
<li><p>Extend the previous plot by also plotting this set of values but this time
using a different color (<code class="docutils literal notranslate"><span class="pre">#56B4E9</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is dataset 2</span>
<span class="n">data2_y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.14</span><span class="p">,</span> <span class="mf">8.14</span><span class="p">,</span> <span class="mf">8.74</span><span class="p">,</span> <span class="mf">8.77</span><span class="p">,</span> <span class="mf">9.26</span><span class="p">,</span> <span class="mf">8.10</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="mf">3.10</span><span class="p">,</span> <span class="mf">9.13</span><span class="p">,</span> <span class="mf">7.26</span><span class="p">,</span> <span class="mf">4.74</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Then add another color (<code class="docutils literal notranslate"><span class="pre">#009E73</span></code>) which plots the second dataset, scaled
by 2.0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we multiply all elements of data2_y by 2.0</span>
<span class="n">data2_y_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data2_y</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Try to add a legend to the plot with <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="(in Matplotlib v3.10.7)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.legend()</span></code></a> and searching the web for clues on
how to add labels to each dataset.
You can also consult this great
<a class="reference external" href="https://matplotlib.org/stable/users/explain/quick_start.html">quick start guide</a>.</p></li>
<li><p>At the end it should look like this one:</p>
<figure class="align-default">
<img alt="Result of the exercise" src="../_images/exercise.png" />
</figure>
</li>
<li><p>Experiment also by using named colors (e.g. “red”) instead of the hex-codes.</p></li>
</ul>
</div>
<p><a class="reference external" href="../plotting-matplotlib/#solution-0">In plotting-matplotlib.md:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># this is dataset 1 from</span>
<span class="c1"># https://en.wikipedia.org/wiki/Anscombe%27s_quartet</span>
<span class="n">data_x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.04</span><span class="p">,</span> <span class="mf">6.95</span><span class="p">,</span> <span class="mf">7.58</span><span class="p">,</span> <span class="mf">8.81</span><span class="p">,</span> <span class="mf">8.33</span><span class="p">,</span> <span class="mf">9.96</span><span class="p">,</span> <span class="mf">7.24</span><span class="p">,</span> <span class="mf">4.26</span><span class="p">,</span> <span class="mf">10.84</span><span class="p">,</span> <span class="mf">4.82</span><span class="p">,</span> <span class="mf">5.68</span><span class="p">]</span>

<span class="c1"># this is dataset 2</span>
<span class="hll"><span class="n">data2_y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.14</span><span class="p">,</span> <span class="mf">8.14</span><span class="p">,</span> <span class="mf">8.74</span><span class="p">,</span> <span class="mf">8.77</span><span class="p">,</span> <span class="mf">9.26</span><span class="p">,</span> <span class="mf">8.10</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="mf">3.10</span><span class="p">,</span> <span class="mf">9.13</span><span class="p">,</span> <span class="mf">7.26</span><span class="p">,</span> <span class="mf">4.74</span><span class="p">]</span>
</span>
<span class="c1"># here we multiply all elements of data2_y by 2.0</span>
<span class="hll"><span class="n">data2_y_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data2_y</span><span class="p">]</span>
</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data_y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#E69F00&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;set 1&quot;</span><span class="p">)</span>
<span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data2_y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#56B4E9&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;set 2&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data2_y_scaled</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#009E73&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;set 2 (scaled)&quot;</span><span class="p">)</span>
</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;we should label the x axis&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;we should label the y axis&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;some title&quot;</span><span class="p">)</span>
<span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span>
<span class="c1"># uncomment the next line if you would like to save the figure to disk</span>
<span class="c1"># fig.savefig(&quot;exercise-plot.png&quot;)</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../plotting-matplotlib/#exercise-1">In plotting-matplotlib.md:</a></p>
<div class="admonition-exercise-customization-1-log-scale-in-matplotlib-15-min exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise Customization-1: log scale in Matplotlib (15 min)</p>
<p>In this exercise we will learn how to use log scales.</p>
<ul>
<li><p>To demonstrate this we first fetch some data to plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/plotly/datasets/master/gapminder_with_codes.csv&quot;</span>
<span class="p">)</span>
<span class="n">gapminder_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;year == 2007&quot;</span><span class="p">)</span>

<span class="n">gapminder_data</span>
</pre></div>
</div>
</li>
<li><p>Try the above snippet in a notebook and it will give you an overview over the data.</p></li>
<li><p>Then we can plot the data, first using a linear scale:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">gapminder_data</span><span class="p">[</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gapminder_data</span><span class="p">[</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the result but we realize that a linear scale is not ideal here:</p>
<figure class="align-default">
<img alt="Gapminder data plotted using a linear scale" src="../_images/gapminder-linear.png" />
</figure>
</li>
<li><p>Your task is to switch to a log scale and arrive at this result:</p>
<figure class="align-default">
<img alt="Gapminder data plotted using log scale" src="../_images/gapminder-log.png" />
</figure>
</li>
<li><p>What does <code class="docutils literal notranslate"><span class="pre">alpha=0.5</span></code> do?</p></li>
</ul>
</div>
<p><a class="reference external" href="../plotting-matplotlib/#solution-1">In plotting-matplotlib.md:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>See <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xscale.html#matplotlib.axes.Axes.set_xscale" title="(in Matplotlib v3.10.7)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ax.set_xscale()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">gapminder_data</span><span class="p">[</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gapminder_data</span><span class="p">[</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.artist.Artist.set_alpha.html#matplotlib.artist.Artist.set_alpha" title="(in Matplotlib v3.10.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code></a> sets transparency
of points.</p></li>
</ul>
</div>
<p><a class="reference external" href="../plotting-matplotlib/#exercise-2">In plotting-matplotlib.md:</a></p>
<div class="admonition-exercise-customization-2-preparing-a-plot-for-publication-15-min exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise Customization-2: preparing a plot for publication (15 min)</p>
<p>Often we need to create figures for presentation slides and for publications
but both have different requirements: for presentation slides you have the whole
screen but for a figure in a publication you may only have few centimeters/inches.</p>
<p>For figures that go to print it is good practice to look at them at the size
they will be printed in and then often fonts and tickmarks are too small.</p>
<p>Your task is to make the tickmarks and the axis label font larger, using
<a class="reference external" href="https://matplotlib.org/stable/users/explain/quick_start.html#parts-of-a-figure">Matplotlib parts of a figure</a>
and web search, and to arrive at this:</p>
<figure class="align-default">
<img alt="Gapminder data plotted with larger font and larger ticks" src="../_images/gapminder-larger-font.png" />
</figure>
</div>
<p><a class="reference external" href="../plotting-matplotlib/#solution-2">In plotting-matplotlib.md:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>See <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.tick_params.html#matplotlib.axes.Axes.tick_params" title="(in Matplotlib v3.10.7)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ax.tick_params</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">gapminder_data</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

<span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;GDP per capita (PPP dollars)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span><span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Life expectancy (years)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span>
<span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span class="hll"><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="plotting-with-vega-altairhttpsaltair-vizgithubio">
<h3>Plotting with <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a><a class="headerlink" href="#plotting-with-vega-altairhttpsaltair-vizgithubio" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../plotting-vega-altair/#exercise-0">In plotting-vega-altair.md:</a></p>
<div class="admonition-plotting-1-using-visual-channels-to-re-arrange-plots exercise important admonition" id="exercise-0">
<p class="admonition-title">Plotting-1: Using visual channels to re-arrange plots</p>
<ol class="arabic">
<li><p>Try to reproduce the above plots if they are not already in your notebook.</p></li>
<li><p>Above we have plotted the monthly precipitation for two cities side by side
using a stacked plot. Try to arrive at the following plot where months are
along the y-axis and the precipitation amount is along the x-axis:</p>
<figure class="align-default">
<img alt="../_images/precipitation-stacked-y.svg" src="../_images/precipitation-stacked-y.svg" />
</figure>
</li>
<li><p>Ask the Internet or AI how to change the axis title from “precipitation”
to “Precipitation (mm)”.</p></li>
<li><p>Modify the temperature range plot to show the temperature ranges for the
two cities side by side like this:</p>
<figure class="align-default">
<img alt="../_images/temperature-ranges-side.svg" src="../_images/temperature-ranges-side.svg" />
</figure>
</li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ol class="arabic">
<li><p>Copy-paste code blocks from above.</p></li>
<li><p>Basically we switched x and y:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>This can be done with the following modification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;precipitation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm)&quot;</span><span class="p">),</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>We added one line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
    <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;min temperature&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<p><a class="reference external" href="../plotting-vega-altair/#exercise-1">In plotting-vega-altair.md:</a></p>
<div class="admonition-plotting-2-adapting-a-gallery-example exercise important admonition" id="exercise-1">
<p class="admonition-title">Plotting-2: Adapting a gallery example</p>
<p><strong>This is a great exercise which is very close to real life.</strong></p>
<ul class="simple">
<li><p>Browse the <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Vega-Altair example gallery</a>.</p></li>
<li><p>Select one example that is close to your current/recent visualization project
or simply interests you.</p></li>
<li><p>First try to reproduce this example, as-is, in the Jupyter Notebook.</p></li>
<li><p><strong>If you get the error “ModuleNotFoundError: No module named
‘vega_datasets’”, then try one of these examples:</strong> (they do not need the “vega_datasets” module)</p>
<ul>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">Slider cutoff</a>
(<strong>below you can find a walk-through for this example</strong>)</p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/multiline_tooltip_standard.html">Multi-Line tooltip</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/simple_heatmap.html">Heatmap</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/layered_histogram.html">Layered histogram</a></p></li>
</ul>
</li>
<li><p>Then try to print out the data that is used in this example just before the call of the plotting function
to learn about its structure. Consider writing the data to file before changing it.</p></li>
<li><p>Then try to modify the data a bit.</p></li>
<li><p>If you have time, try to feed it different, simplified data.
<strong>This will be key for adapting the examples to your projects.</strong></p></li>
</ul>
<div class="admonition-example-walk-through-for-the-slider-cutoff-example solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Example walk-through for the slider cutoff example</p>
<p>In this walk-through I imagine browsing: <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">https://altair-viz.github.io/gallery/index.html</a></p>
<p>Then this example caught my eye: <a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">https://altair-viz.github.io/gallery/slider_cutoff.html</a></p>
<p>I then copy-paste the example code into a notebook and try to run it and I get
the same result.</p>
<p>If you get stuck below, <strong>you can also browse all the steps</strong> in a <a class="reference external" href="https://nbviewer.org/github/AaltoSciComp/python-for-scicomp/blob/master/resources/notebooks/plotting-exercise-2.ipynb">notebook
using
nbviewer</a>.</p>
<p>Next, there is a lot of code that I don’t (need to) understand yet but my eyes are trying to find
<code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code> which tells me that the data must be the “df” in <code class="docutils literal notranslate"><span class="pre">alt.Chart(df)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
<span class="p">)</span>
</pre></div>
</div>
<p>My next step will be to print out the data <code class="docutils literal notranslate"><span class="pre">df</span></code> just before the call to <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>The print reveals that <code class="docutils literal notranslate"><span class="pre">df</span></code> is a dataframe which contains x and y values:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    xval       yval
0      0   0.496714
1      1   0.358450
2      2   1.006138
3      3   2.529168
4      4   2.295015
..   ...        ...
95    95 -10.712354
96    96 -10.416233
97    97 -10.155178
98    98 -10.150065
99    99 -10.384652

[100 rows x 2 columns]
</pre></div>
</div>
<p>The next thing that often helps me is to save the data to a comma-separated
values (CSV) file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>I then open the file in an editor and see that it contains 100 rows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
0,0.4967141530112327
1,0.358449851840048
2,1.0061383899407406
3,2.5291682463487657
4,2.2950148716254297
5,2.060877914676249
6,3.6400907301836405
7,4.407525459336549
8,3.938051073401597
9,4.4806111169875615
...
</pre></div>
</div>
<p>Saving the data to file often helps me to see the structure of the data and now
I am in a position to replace this with my own data. I create a file called
“mydata.csv” and there I use the maximum temperatures for months 1-10 from the
Tromso monthly data which we used further up:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
01,7.7
02,6.6
03,4.5
04,9.8
05,17.7
06,25.4
07,26.7
08,25.1
09,19.3
10,9.8
</pre></div>
</div>
<p>In the notebook I then verify that the reading of the data works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mydata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">mydata</span>
</pre></div>
</div>
<p>Now I can replace the example with my own data (note how I now can comment out
some code that I don’t need any longer):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="c1"># import numpy as np</span>

<span class="c1"># rand = np.random.RandomState(42)</span>

<span class="c1"># df = pd.DataFrame({</span>
<span class="c1">#     &#39;xval&#39;: range(100),</span>
<span class="c1">#     &#39;yval&#39;: rand.randn(100).cumsum()</span>
<span class="c1"># })</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># print(df)</span>
<span class="hll"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Seems to work! I then make few more adjustments (I want the slider to work on
the y-axis and have a more reasonable default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="hll"><span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll"><span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
<span class="hll">        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">yval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
</span>        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>My next steps would then be to change axis titles, display the month names, add
a legend, and refine from here.</p>
<p><strong>You can also browse all the steps</strong> in a <a class="reference external" href="https://nbviewer.org/github/AaltoSciComp/python-for-scicomp/blob/master/resources/notebooks/plotting-exercise-2.ipynb">notebook using
nbviewer</a>.</p>
</div>
</div>
</section>
<section id="working-with-data">
<h3>Working with Data<a class="headerlink" href="#working-with-data" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../work-with-data/#exercise-0">In work-with-data.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p>You have a model that you have been training for a while.
Lets assume it’s a relatively simple neural network (consisting of a
network structure and it’s associated weights).</p>
<p>Let’s consider 2 scenarios</p>
<p>A: You have a different project, that is supposed to take this model, and
do some processing with it to determine it’s efficiency after different
times of training.</p>
<p>B: You want to publish the model and make it available to others.</p>
<p>What are good options to store the model in each of these scenarios?</p>
</div>
<p><a class="reference external" href="../work-with-data/#solution-0">In work-with-data.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>A:</p>
<blockquote>
<div><p>Some export into a binary format that can be easily read. E.g. pickle
or a specific export function from the library you use.</p>
<p>It also depends on whether you intend to make the intermediary steps
available to others. If you do, you might also want to consider storing
structure and weights separately or use a format specific for the
type of model you are training to keep the data independent of the
library.</p>
</div></blockquote>
<p>B:</p>
<blockquote>
<div><p>You might want to consider a more general format that is supported by
many libraries, e.g. ONNX, or a format that is specifically designed
for the type of model you are training.</p>
<p>You might also want to consider additionally storing the model in a way
that is easily readable by humans, to make it easier for others to
understand the model.</p>
</div></blockquote>
</div>
</section>
<section id="scripts">
<h3>Scripts<a class="headerlink" href="#scripts" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../scripts/#exercise-0">In scripts.rst:</a></p>
<div class="admonition-scripts-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Scripts-1</p>
<ol class="arabic">
<li><p>Download the <a class="reference download internal" download="" href="../_downloads/4b858dab9366f77b3641c99adece5fd2/weather_observations.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">weather_observations.ipynb</span></code></a> and upload them to your Jupyterlab. The script plots the temperature data for Tapiola in Espoo. The data is originally from <a class="reference external" href="https://rp5.kz">rp5.kz</a> and was slightly adjusted for this lecture.</p>
<p><strong>Hint:</strong> Copy the URL above (right-click) and in JupyterLab, use
File → Open from URL → Paste the URL.  It will both download it to
the directory JupyterLab is in and open it for you.</p>
</li>
<li><p>Open a terminal in Jupyter: File → New Launcher, then click
“Terminal” there. (if you do it this way, it will be in the right
directory.  File → New → Terminal might not be.)</p></li>
<li><p>Convert the Jupyter script to a Python script by calling:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>jupyter<span class="w"> </span>nbconvert<span class="w"> </span>--to<span class="w"> </span>script<span class="w"> </span>weather_observations.ipynb
</pre></div>
</div>
</li>
<li><p>Run the script (note: you may have <code class="docutils literal notranslate"><span class="pre">python3</span></code> rather than <code class="docutils literal notranslate"><span class="pre">python</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>weather_observations.py
</pre></div>
</div>
</li>
</ol>
</div>
<p><a class="reference external" href="../scripts/#exercise-1">In scripts.rst:</a></p>
<div class="admonition-scripts-2 exercise important admonition" id="exercise-1">
<p class="admonition-title">Scripts-2</p>
<ol class="arabic simple">
<li><p>Take the Python script (<code class="docutils literal notranslate"><span class="pre">weather_observations.py</span></code>) we have written in the preceding exercise and use
<a class="reference external" href="https://docs.python.org/3/library/argparse.html#module-argparse" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a> to specify the input (URL) and output files and allow the start and end dates to be set.</p>
<ul class="simple">
<li><p>Hint: try not to do it all at once, but add one or two arguments, test, then add more, and so on.</p></li>
<li><p>Hint: The input and output filenames make sense as positional arguments, since they must always be given.  Input is usually first, then output.</p></li>
<li><p>Hint: The start and end dates should be optional parameters with the defaults as they are in the current script.</p></li>
</ul>
</li>
<li><p>Execute your script for a few different time intervals (e.g. from January 2019 to June 2020, or from May 2020 to October 2020).
Also try using this data for Cairo: <code class="docutils literal notranslate"><span class="pre">https://raw.githubusercontent.com/AaltoSciComp/python-for-scicomp/master/resources/data/scripts/weather_cairo.csv</span></code></p></li>
</ol>
</div>
<p><a class="reference external" href="../scripts/#solution-0">In scripts.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="hll"><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
</span>
<span class="hll"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
</span><span class="hll"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Input data file&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output plot file&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--start&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;01/01/2019&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Start date in DD/MM/YYYY format&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="s2">&quot;--end&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;16/10/2021&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;End date in DD/MM/YYYY format&quot;</span><span class="p">)</span>
</span>
<span class="hll"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span>
<span class="c1"># load the data</span>
<span class="hll"><span class="n">weather</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
</span>
<span class="c1"># define the start and end time for the plot</span>
<span class="hll"><span class="n">start_date</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="n">end_date</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span>
<span class="c1"># preprocess the data</span>
<span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># select the data</span>
<span class="n">weather</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span><span class="p">)]</span>

<span class="c1"># plot the data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="c1"># start the figure.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">],</span> <span class="n">weather</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
<span class="c1"># label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date of observation&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature in Celsius&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temperature Observations&quot;</span><span class="p">)</span>
<span class="c1"># adjust the date labels, so that they look nicer</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>

<span class="c1"># save the figure</span>
<span class="hll"><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<p><a class="reference external" href="../scripts/#exercise-2">In scripts.rst:</a></p>
<div class="admonition-scripts-3 exercise important admonition" id="exercise-2">
<p class="admonition-title">Scripts-3</p>
<ol class="arabic simple">
<li><p>Download the <a class="reference download external" download="" href="https://raw.githubusercontent.com/AaltoSciComp/python-for-scicomp/master/resources/code/scripts/optionsparser.py"><code class="xref download docutils literal notranslate"><span class="pre">optionsparser.py</span></code></a>
function and load it into your working folder in Jupyterlab (Hint: in JupyterLab, File → Open from URL).
Modify the previous script to use a config file parser to read all arguments. The config file is passed in as a single argument on the command line
(using e.g. <a class="reference external" href="https://docs.python.org/3/library/argparse.html#module-argparse" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.argv" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code></a>) still needs to be read from the command line.</p></li>
<li><p>Run your script with different config files.</p></li>
</ol>
</div>
<p><a class="reference external" href="../scripts/#solution-1">In scripts.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>The modified <strong>weather_observations.py</strong> script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># coding: utf-8</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="hll"><span class="kn">from</span><span class="w"> </span><span class="nn">optionsparser</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_parameters</span>
</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span> 

<span class="c1"># Lets start reading our confg file. we&#39;ll use argparse to get the config file.</span>
<span class="hll"><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
</span><span class="hll"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span><span class="hll">                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Config File name &quot;</span><span class="p">)</span>
</span><span class="hll"><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span>
<span class="c1"># Set optional parameters with default values and required parameter values with their type</span>
<span class="hll"><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">           <span class="s2">&quot;xlabel&quot;</span>      <span class="p">:</span> <span class="s2">&quot;Date of observation&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;title&quot;</span>       <span class="p">:</span> <span class="s2">&quot;Weather Observations&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;start&quot;</span>       <span class="p">:</span> <span class="s2">&quot;01/06/2021&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;end&quot;</span>         <span class="p">:</span> <span class="s2">&quot;01/10/2021&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;output&quot;</span>      <span class="p">:</span> <span class="s2">&quot;weather.png&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;ylabel&quot;</span>      <span class="p">:</span> <span class="s2">&quot;Temperature in Celsius&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="s2">&quot;data_column&quot;</span> <span class="p">:</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span>
</span><span class="hll">           <span class="p">}</span>
</span><span class="hll">
</span><span class="hll"><span class="n">required</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">           <span class="s2">&quot;input&quot;</span>  <span class="p">:</span> <span class="nb">str</span>
</span><span class="hll">           <span class="p">}</span>
</span>           
<span class="c1"># now, parse the config file</span>
<span class="hll"><span class="n">parameters</span> <span class="o">=</span> <span class="n">get_parameters</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
</span>
<span class="c1"># load the data</span>
<span class="hll"><span class="n">weather</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">input</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
</span>
<span class="c1"># obtain start and end date</span>
<span class="hll"><span class="n">start_date</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="n">end_date</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span>
<span class="c1"># Data preprocessing</span>
<span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># select the data</span>
<span class="n">weather</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span><span class="p">)]</span>

<span class="c1"># Data plotting</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="c1"># start the figure.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">weather</span><span class="p">[</span><span class="s1">&#39;Local time&#39;</span><span class="p">],</span> <span class="n">weather</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">])</span>
<span class="c1"># label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date of observation&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature in Celsius&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temperature Observations&quot;</span><span class="p">)</span>
<span class="c1"># adjust the date labels, so that they look nicer</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>


<span class="c1"># save the figure</span>
<span class="hll"><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="profiling">
<h3>Profiling<a class="headerlink" href="#profiling" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../profiling/#exercise-0">In profiling.md:</a></p>
<div class="admonition-exercise-practicing-profiling exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Practicing profiling</p>
<p>In this exercise we will use the Scalene profiler to find out where most of the time is spent
and most of the memory is used in a given code example.</p>
<p>Please try to go through the exercise in the following steps:</p>
<ol class="arabic">
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">scalene</span></code> is installed in your environment (if you have followed
this course from the start and installed the recommended software
environment, then it is).</p></li>
<li><p>Download Leo Tolstoy’s “War and Peace” from the following link (the text is
provided by <a class="reference external" href="https://www.gutenberg.org/">Project Gutenberg</a>):
<a class="reference external" href="https://www.gutenberg.org/cache/epub/2600/pg2600.txt">https://www.gutenberg.org/cache/epub/2600/pg2600.txt</a>
(right-click and “save as” to download the file and <strong>save it as “book.txt”</strong>).</p></li>
<li><p><strong>Before</strong> you run the profiler, try to predict in which function the code
(the example code is below)
will spend most of the time and in which function it will use most of the
memory.</p></li>
<li><p>Save the example code as <code class="docutils literal notranslate"><span class="pre">example.py</span></code> and
run the <code class="docutils literal notranslate"><span class="pre">scalene</span></code> profiler on the following code example and browse the
generated HTML report to find out where most of the time is spent and where
most of the memory is used:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>scalene<span class="w"> </span>example.py
</pre></div>
</div>
<p>Alternatively you can do this (and then open the generated file in a browser):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>scalene<span class="w"> </span>example.py<span class="w"> </span>--html<span class="w"> </span>&gt;<span class="w"> </span>profile.html
</pre></div>
</div>
<p>You can find an example of the generated HTML report in the solution below.</p>
</li>
<li><p>Does the result match your prediction? Can you explain the results?</p></li>
</ol>
<p>Example code (<code class="docutils literal notranslate"><span class="pre">example.py</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;&quot;&quot;</span>
<span class="go">The code below reads a text file and counts the number of unique words in it</span>
<span class="gp gp-VirtualEnv">(case-insensitive)</span><span class="go">.</span>
<span class="go">&quot;&quot;&quot;</span>
<span class="go">import re</span>


<span class="go">def count_unique_words1(file_path: str) -&gt; int:</span>
<span class="go">    with open(file_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as file:</span>
<span class="go">        text = file.read()</span>
<span class="go">    words = re.findall(r&quot;\b\w+\b&quot;, text.lower())</span>
<span class="go">    return len(set(words))</span>


<span class="go">def count_unique_words2(file_path: str) -&gt; int:</span>
<span class="go">    unique_words = []</span>
<span class="go">    with open(file_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as file:</span>
<span class="go">        for line in file:</span>
<span class="go">            words = re.findall(r&quot;\b\w+\b&quot;, line.lower())</span>
<span class="go">            for word in words:</span>
<span class="go">                if word not in unique_words:</span>
<span class="go">                    unique_words.append(word)</span>
<span class="go">    return len(unique_words)</span>


<span class="go">def count_unique_words3(file_path: str) -&gt; int:</span>
<span class="go">    unique_words = set()</span>
<span class="go">    with open(file_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as file:</span>
<span class="go">        for line in file:</span>
<span class="go">            words = re.findall(r&quot;\b\w+\b&quot;, line.lower())</span>
<span class="go">            for word in words:</span>
<span class="go">                unique_words.add(word)</span>
<span class="go">    return len(unique_words)</span>


<span class="go">def main():</span>
<span class="gp">    # </span>book.txt<span class="w"> </span>is<span class="w"> </span>downloaded<span class="w"> </span>from<span class="w"> </span>https://www.gutenberg.org/cache/epub/2600/pg2600.txt
<span class="go">    _result = count_unique_words1(&quot;book.txt&quot;)</span>
<span class="go">    _result = count_unique_words2(&quot;book.txt&quot;)</span>
<span class="go">    _result = count_unique_words3(&quot;book.txt&quot;)</span>


<span class="go">if __name__ == &quot;__main__&quot;:</span>
<span class="go">    main()</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../_images/exercise1.png"><img alt="Result of the profiling run for the above code example." src="../_images/exercise1.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Result of the profiling run for the above code example. You can click on the image to make it larger.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Results:</p>
<ul class="simple">
<li><p>Most time is spent in the <code class="docutils literal notranslate"><span class="pre">count_unique_words2</span></code> function.</p></li>
<li><p>Most memory is used in the <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> function.</p></li>
</ul>
<p>Explanation:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words2</span></code> function is the slowest because it <strong>uses a list</strong>
to store unique words and checks if a word is already in the list before
adding it.
Checking whether a list contains an element might require traversing the
whole list, which is an O(n) operation. As the list grows in size,
the lookup time increases with the size of the list.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> and <code class="docutils literal notranslate"><span class="pre">count_unique_words3</span></code> functions are faster
because they <strong>use a set</strong> to store unique words.
Checking whether a set contains an element is an O(1) operation.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> function uses the most memory because it <strong>creates
a list of all words</strong> in the text file and then <strong>creates a set</strong> from that
list.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words3</span></code> function uses less memory because it traverses
the text file line by line instead of reading the whole file into memory.</p></li>
</ul>
<p>What we can learn from this exercise:</p>
<ul class="simple">
<li><p>When processing large files, it can be good to read them line by line
or in batches
instead of reading the whole file into memory.</p></li>
<li><p>It is good to get an overview over standard data structures and their
advantages and disadvantages (e.g. adding an element to a list is fast but checking whether
it already contains the element can be slow).</p></li>
</ul>
</div>
</div>
</section>
<section id="scipy">
<h3>SciPy<a class="headerlink" href="#scipy" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../scipy/#exercise-0">In scipy.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p>Do the following exercise <strong>or</strong> read the documentation and
understand the relevant functions of SciPy:</p>
<p>Define a function of one variable and using
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad">scipy.integrate.quad</a>
calculate the integral of your function in the
interval <code class="docutils literal notranslate"><span class="pre">[0.0,</span> <span class="pre">4.0]</span></code>. Then vary the interval and also modify the function and check
whether scipy can integrate it.</p>
</div>
<p><a class="reference external" href="../scipy/#solution-0">In scipy.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">integrate</span>

<span class="k">def</span><span class="w"> </span><span class="nf">myfunction</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># you need to define result</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">integral</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">myfunction</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad">quad</a>
uses the Fortran library QUADPACK, which one can assume is pretty
good.  You can also see a whole lot of scientific information about
the function on the docs page - including the scientific names of
the methods used.</p>
</div>
<p><a class="reference external" href="../scipy/#exercise-1">In scipy.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p>Do the following exercise <strong>or</strong> read the documentation and
understand the relevant functions of SciPy:</p>
<p>Use the SciPy sparse matrix functionality to create a random sparse
matrix with a probability of non-zero elements of 0.05 and size 10000
x 10000. The use the SciPy sparse linear algebra support to calculate
the matrix-vector product of the sparse matrix you just created and a
random vector. Use the %timeit macro to measure how long it
takes. Does the optional <code class="docutils literal notranslate"><span class="pre">format</span></code> argument when you create the
sparse matrix make a difference?</p>
<p>Then, compare to how long it takes if you’d instead first convert the
sparse matrix to a normal NumPy dense array, and use the NumPy <code class="docutils literal notranslate"><span class="pre">dot</span></code>
method to calculate the matrix-vector product.</p>
<p>Can you figure out a quick rule of thumb when it’s worth using a
sparse matrix representation vs. a dense representation?</p>
</div>
<p><a class="reference external" href="../scipy/#solution-1">In scipy.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>The basic code to do the test is:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.sparse</span>

<span class="n">vector</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csc&#39;</span><span class="p">)</span>

<span class="c1"># We time this line</span>
<span class="n">matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>
</div>
<p>From the top of the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html">spare matrix module documentation</a>, we can
see there are a variety of different available sparse matrix types:
<code class="docutils literal notranslate"><span class="pre">bsr</span></code>, <code class="docutils literal notranslate"><span class="pre">coo</span></code>, <code class="docutils literal notranslate"><span class="pre">csr</span></code>, <code class="docutils literal notranslate"><span class="pre">csc</span></code>, etc.  These each represent a
different way of storing the matrices.</p>
<p>It seems that <code class="docutils literal notranslate"><span class="pre">csr</span></code> and <code class="docutils literal notranslate"><span class="pre">csc</span></code> are fairly fast.  <code class="docutils literal notranslate"><span class="pre">lil</span></code> and
<code class="docutils literal notranslate"><span class="pre">dok</span></code> are slow but it says that these are good for creating
matrices with random insertions.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">csr</span></code> takes 7ms, <code class="docutils literal notranslate"><span class="pre">lil</span></code> 42ms, <code class="docutils literal notranslate"><span class="pre">dok</span></code> 1600ms, and
converting to a non-sparse array <code class="docutils literal notranslate"><span class="pre">matrix.toarray()</span></code> and
multiplying takes 64ms on one particular computer.</p>
<p>This code allows us to time the performance at different
densities.  It seems that with the <code class="docutils literal notranslate"><span class="pre">csr</span></code> format, sparse is better
below densities of around .4 to .5:</p>
<p>..code-block:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">for density in [.01, .05, .1, .2, .3, .4, .5]:</span>
<span class="go">    matrix = scipy.sparse.rand(10000, 10000, density=density, format=&#39;csr&#39;)</span>
<span class="go">    time_sparse = timeit.timeit(&#39;matrix.dot(vector)&#39;, number=10, globals=globals())</span>
<span class="go">    matrix2 = matrix.toarray()</span>
<span class="go">    time_full = timeit.timeit(&#39;matrix2.dot(vector)&#39;, number=10, globals=globals())</span>
<span class="go">    print(f&quot;{density} {time_sparse:.3f} {time_full:.3f}&quot;)</span>
</pre></div>
</div>
</div>
</section>
<section id="library-ecosystem">
<h3>Library ecosystem<a class="headerlink" href="#library-ecosystem" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../libraries/#exercise-0">In libraries.rst:</a></p>
<div class="admonition-libraries-1-1-libraries-in-your-work exercise important admonition" id="exercise-0">
<p class="admonition-title">Libraries 1.1: Libraries in your work</p>
<p>What libraries do you use in your work?  What have you made, which
you could have reused from some other source.  What have you used
from some other source that you wished you had re-created?</p>
<p>Discuss in the collaborative document.</p>
</div>
<p><a class="reference external" href="../libraries/#solution-0">In libraries.rst:</a></p>
<div class="admonition-libraries-1-1 solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Libraries 1.1</p>
<p>… is there anything to say here?</p>
</div>
<p><a class="reference external" href="../libraries/#exercise-1">In libraries.rst:</a></p>
<div class="admonition-libraries-1-2-evaluating-packages exercise important admonition" id="exercise-1">
<p class="admonition-title">Libraries 1.2: Evaluating packages</p>
<p>Below are some links to some packages, both public and made by the
authors of this lesson.  Evaluate them, considering “would I use
this in my project?”</p>
<ol class="loweralpha simple">
<li><p><a class="reference external" href="https://github.com/networkx/networkx/">https://github.com/networkx/networkx/</a></p></li>
<li><p>some code on webpage in a paper’s footnote</p></li>
<li><p><a class="reference external" href="https://github.com/rkdarst/pcd">https://github.com/rkdarst/pcd</a></p></li>
<li><p><a class="reference external" href="https://github.com/dftlibs/numgrid">https://github.com/dftlibs/numgrid</a></p></li>
<li><p><a class="reference external" href="https://github.com/rkdarst/dynbench">https://github.com/rkdarst/dynbench</a></p></li>
<li><p><a class="reference external" href="https://vpython.org/">https://vpython.org/</a></p></li>
</ol>
</div>
<p><a class="reference external" href="../libraries/#solution-1">In libraries.rst:</a></p>
<div class="admonition-libraries-1-2 solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Libraries 1.2</p>
<ol class="loweralpha simple">
<li><p>networkx: This seems to be a relatively large, active project
using best practices.  Probably usable.</p></li>
<li><p>I would probably use it if I had to, but would prefer not to.</p></li>
<li><p>This (written by one of the authors of this lesson) has no
documenting, no community, no best practices, and is very old.
Probably not a good idea to try to use it</p></li>
<li><p>This project uses best practices, but doesn’t seem to have a big
community.  It’s probably fine to use, but who knows if it will
be maintained 10 years from now.  It does have automated tests
via Github Actions (<code class="docutils literal notranslate"><span class="pre">.github/workflows</span></code> and the green checks),
so the authors have put some work into making it correct.</p></li>
<li><p>This (also written by one of the authors) looks like it was made
for a paper of some sort.  It has some minimal documentation,
but still is missing many best practices and is clearly not
maintained anymore (look at the ancient pull request).  Probably
not a good idea to use unless you have to.</p></li>
<li><p>This project has a pretty website, and some information.  But
seems to not be using best practices of an open repository, and
custom locations which could disappear at any time.</p></li>
</ol>
<p>You notice that several of the older projects here were written by
one of the authors of this lesson.  It goes to show that everyone
starts somewhere and improves over time - don’t feel bad if your
work isn’t perfect, as long as you keep trying to get better!</p>
</div>
</section>
<section id="dependency-management">
<h3>Dependency management<a class="headerlink" href="#dependency-management" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../dependencies/#exercise-0">In dependencies.rst:</a></p>
<div class="admonition-dependencies-1-discuss-dependency-management-5-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Dependencies-1: Discuss dependency management (5 min)</p>
<p>Please discuss and answer via <strong>collaborative document</strong> the
following questions:</p>
<ul class="simple">
<li><p>How do you install Python packages (libraries) that you use in your work?
From PyPI using pip? From other places using pip? Using conda?</p></li>
<li><p>How do you track/record the dependencies? Do you write them into a file or README? Into
<code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>?</p></li>
<li><p>If you track dependencies in a file, why do you do this?</p></li>
<li><p>Have you ever experienced that a project needed a different version of a Python
library than the one on your computer? If yes, how did you solve it?</p></li>
</ul>
</div>
<p><a class="reference external" href="../dependencies/#exercise-1">In dependencies.rst:</a></p>
<div class="admonition-dependencies-2-package-language-detective-5-min exercise important admonition" id="exercise-1">
<p class="admonition-title">Dependencies-2: Package language detective (5 min)</p>
<p>Think about the following sentences:</p>
<ol class="arabic simple">
<li><p>Yes, you can install my package with pip from GitHub.</p></li>
<li><p>I forgot to specify my channels, so my packages came from the defaults.</p></li>
<li><p>I have a Miniforge installation and I use mamba to create my environments.</p></li>
</ol>
<p>What hidden information is given in these sentences?</p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>The package is provided as a pip package. However, it is most likely
not uploaded to PyPI as it needs to be installed from a repository.</p></li>
<li><p>In this case the person saying the sentence is most likely using
Anaconda or Miniconda because these tools use the <code class="docutils literal notranslate"><span class="pre">defaults</span></code>-channel
as the default channel. They probably meant to install software from
conda-forge, but forgot to specify the channel.</p></li>
<li><p>Miniforge uses conda-forge as the default channel. So unless some
other channel has been specified, packages installed with these
tools come from conda-forge as well.</p></li>
</ol>
</div>
</div>
<p><a class="reference external" href="../dependencies/#exercise-2">In dependencies.rst:</a></p>
<div class="admonition-dependencies-3-create-a-python-environment-15-min exercise important admonition" id="exercise-2">
<p class="admonition-title">Dependencies-3: Create a Python environment (15 min)</p>
<p>Use conda or venv to create the environment presented in the
example.</p>
</div>
<p><a class="reference external" href="../dependencies/#exercise-3">In dependencies.rst:</a></p>
<div class="admonition-dependencies-4-export-an-environment-15-min exercise important admonition" id="exercise-3">
<p class="admonition-title">Dependencies-4: Export an environment (15 min)</p>
<p>Export the environment you previously created.</p>
</div>
</section>
<section id="binder">
<h3>Binder<a class="headerlink" href="#binder" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../binder/#exercise-0">In binder.rst:</a></p>
<div class="admonition-binder-1-discuss-better-strategies-than-only-code-sharing-10-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Binder-1: Discuss better strategies than only code sharing (10 min)</p>
<p>Lea is a PhD student in computational biology and after 2 years of intensive
work, she is finally ready to publish her first paper. The code she has used
for analyzing her data is available on GitHub but her supervisor who is an
advocate of open science told her that sharing code is not sufficient.</p>
<p><strong>Why is it possibly not enough to share “just” your code?
What problems can you anticipate 2-5 years from now?</strong></p>
<p>We form small groups (4-5 persons) and discuss in groups. If the workshop is
online, each group will join a breakout room.
If joining a group is not possible or practical, we use the shared document
to discuss this collaboratively.</p>
<p>Each group write a summary (bullet points) of the discussion in the workshop
shared document (the link will be provided by your instructors).</p>
</div>
<p><a class="reference external" href="../binder/#exercise-1">In binder.rst:</a></p>
<div class="admonition-binder-2-exercise-demo-make-your-notebooks-reproducible-by-anyone-15-min exercise important admonition" id="exercise-1">
<p class="admonition-title">Binder-2: Exercise/demo: Make your notebooks reproducible by anyone (15 min)</p>
<p>Instructor demonstrates this.  <strong>This exercise (and all following)
requires git/GitHub knowledge and accounts, which wasn’t a
prerequisite of this course.  Thus, this is a demo (and might even
be too fast for you to type-along).  Watch the video if you
are reading this later on</strong>:</p>
<ul>
<li><p>Creates a GitHub repository</p></li>
<li><p>Uploads the notebook file</p></li>
<li><p>Then we look at the statically rendered version of the notebook on GitHub</p></li>
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file which contains:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pandas==1.2.3
matplotlib==3.4.2
</pre></div>
</div>
</li>
<li><p>Commit and push also this file to your notebook repository.</p></li>
<li><p>Visit <a class="reference external" href="https://mybinder.org">https://mybinder.org</a> and copy paste the code under “Copy the text below …” into your <cite>README.md</cite>:</p>
<img alt="../_images/binder.jpg" src="../_images/binder.jpg" />
</li>
<li><p>Check that your notebook repository now has a “launch binder”
badge in your <cite>README.md</cite> file on GitHub.</p></li>
<li><p>Try clicking the button and see how your repository is launched
on Binder (can take a minute or two). Your notebooks can now be explored and executed in the cloud.</p></li>
<li><p>Enjoy being fully reproducible!</p></li>
</ul>
</div>
<p><a class="reference external" href="../binder/#exercise-2">In binder.rst:</a></p>
<div class="admonition-binder-3-link-a-github-repository-with-zenodo-optional exercise important admonition" id="exercise-2">
<p class="admonition-title">Binder-3: Link a Github repository with Zenodo (optional)</p>
<p><strong>Everything you deposit on Zenodo is meant to be kept (long-term archive).
Therefore we recommend to practice with the Zenodo “sandbox” (practice/test area)
instead:</strong> <a class="reference external" href="https://sandbox.zenodo.org">https://sandbox.zenodo.org</a></p>
<ol class="arabic simple">
<li><p><strong>Link GitHub with Zenodo</strong>:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Go to <a class="reference external" href="https://sandbox.zenodo.org">https://sandbox.zenodo.org</a> (or to <a class="reference external" href="https://zenodo.org">https://zenodo.org</a> for the real upload later, after practicing).</p></li>
<li><p>Log in to Zenodo with your GitHub account. Be aware that you may need to
authorize Zenodo application (Zenodo will redirect you back to GitHub for
Authorization).</p></li>
<li><p>Choose the repository webhooks options.</p></li>
<li><p>From the drop-down menu next to your email address at the top of the page, select GitHub.</p></li>
<li><p>You will be presented with a list of all your Github repositories.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Archiving a repo</strong>:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Select a repository you want to archive on Zenodo.</p></li>
<li><p>Toggle the “on” button next to the repository ou need to archive.</p></li>
<li><p>Click on the Repo that you want to reserve.</p></li>
<li><p>Click on Create release button at the top of the page. Zenodo will redirect you back to GitHub’s repo page to generate a release.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Trigger Zenodo to Archive your repository</strong></p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Go to GitHub and create a release. Zenodo will automatically download a .zip-ball of each new release and register a DOI.</p></li>
<li><p>If this is the first release of your code then you should give it a
version number of v1.0.0. Add description for your release then click the
Publish release button.</p></li>
<li><p>Zenodo takes an archive of your GitHub repository each time you create a new Release.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><strong>To ensure that everything is working</strong>:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Go to <a class="reference external" href="https://zenodo.org/account/settings/github/">https://zenodo.org/account/settings/github/</a> (or the corresponding
sandbox at <a class="reference external" href="https://sandbox.zenodo.org/account/settings/github/">https://sandbox.zenodo.org/account/settings/github/</a>), or the
Upload page (<a class="reference external" href="https://zenodo.org/deposit">https://zenodo.org/deposit</a>), you will find your repo is
listed.</p></li>
<li><p>Click on the repo, Zenodo will redirect you to a page that contains a DOI for your repo will the information that you added to the repo.</p></li>
<li><p>You can edit the archive on Zenodo and/or publish a new version of your software.</p></li>
<li><p>It is recommended that you add a description for your repo and fill in other metadata in the edit page. Instead of editing metadata
manually, you can also add a <code class="docutils literal notranslate"><span class="pre">.zenodo.json</span></code> or a <code class="docutils literal notranslate"><span class="pre">CITATION.cff</span></code> file to your repo and Zenodo will infer the metadata from this file.</p></li>
<li><p>Your code is now published on a Github public repository and archived on Zenodo.</p></li>
<li><p>Update the README file in your repository with the newly created zenodo badge.</p></li>
</ul>
</div></blockquote>
</div>
<p><a class="reference external" href="../binder/#exercise-3">In binder.rst:</a></p>
<div class="admonition-binder-4-link-binder-with-zenodo-10-min exercise important admonition" id="exercise-3">
<p class="admonition-title">Binder-4: Link Binder with Zenodo (10 min)</p>
<p>We will be using an existing Zenodo DOI <a class="reference external" href="https://doi.org/10.5281/zenodo.3247652">10.5281/zenodo.3886864</a> to start Binder:</p>
<blockquote>
<div><ul class="simple">
<li><p>Go to <a class="reference external" href="https://mybinder.org">https://mybinder.org</a> and fill information using Zenodo DOI (as shown on the animation below):</p></li>
</ul>
<img alt="https://miro.medium.com/max/1050/1*xOABVY2hNtVmjV5-LXreFw.gif" src="https://miro.medium.com/max/1050/1*xOABVY2hNtVmjV5-LXreFw.gif" />
<ul class="simple">
<li><p>You can also get a Binder badge and update the README file in the
repository. It is good practice to add both the Zenodo badge and the
corresponding Binder badge.</p></li>
</ul>
</div></blockquote>
</div>
</section>
<section id="parallel-programming">
<h3>Parallel programming<a class="headerlink" href="#parallel-programming" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../parallel/#exercise-0">In parallel.rst:</a></p>
<div class="admonition-parallel-1-multiprocessing exercise important admonition" id="exercise-0">
<p class="admonition-title">Parallel-1, multiprocessing</p>
<p>Here, you find some code which calculates pi by a stochastic
algorithm.  You don’t really need to worry how the algorithm works,
but it computes random points in a 1x1 square, and computes the
number that fall into a circle.  Copy it into a Jupyter notebook
and use the <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code> cell magic on the computation part (the
one highlighted line after timeit below):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make n trials of points in the square.  Return (n, number_in_circle)</span>

<span class="sd">    This is our basic function.  By design, it returns everything it\</span>
<span class="sd">    needs to compute the final answer: both n (even though it is an input</span>
<span class="sd">    argument) and n_inside_circle.  To compute our final answer, all we</span>
<span class="sd">    have to do is sum up the n:s and the n_inside_circle:s and do our</span>
<span class="sd">    computation&quot;&quot;&quot;</span>
    <span class="n">n_inside_circle</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">n_inside_circle</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_inside_circle</span>

<span class="o">%%</span><span class="n">timeit</span>
<span class="hll"><span class="n">n</span><span class="p">,</span> <span class="n">n_inside_circle</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
</span>
<span class="n">pi</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_inside_circle</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<span class="n">pi</span>
</pre></div>
</div>
<p>Using the <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.pool.Pool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.pool.Pool</span></code></a> code from the lesson, run
the <code class="docutils literal notranslate"><span class="pre">sample</span></code> function 10 times, each with <code class="docutils literal notranslate"><span class="pre">10**5</span></code> samples
only.  Combine the results and time the calculation.  What is the
difference in time taken?</p>
<p>NOTE: If you’re working in an interactive environment and this
doesn’t work with the <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> module, install and use
the <code class="docutils literal notranslate"><span class="pre">multiprocess</span></code> module instead!</p>
<p>(optional, advanced) Do the same but with
<a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.pool.ThreadPool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">multiprocessing.pool.ThreadPool</span></code></a> instead.  This works identically
to <code class="docutils literal notranslate"><span class="pre">Pool</span></code>, but uses threads instead of different processes.
Compare the time taken.</p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>See the finished notebook here <a class="reference internal" href="../parallel-pi-multiprocessing/"><span class="doc">Python multithreading solution</span></a>.</p>
<p>You notice the version with <code class="docutils literal notranslate"><span class="pre">ThreadPool</span></code> is no faster, and
probably takes even longer.  This is because this is a
pure-Python function which can not run simultaneously in
multiple threads.</p>
</div>
</div>
<p><a class="reference external" href="../parallel/#exercise-1">In parallel.rst:</a></p>
<div class="admonition-advanced-parallel-2-running-on-a-cluster exercise important admonition" id="exercise-1">
<p class="admonition-title">(advanced) Parallel-2 Running on a cluster</p>
<p>How does the pool know how many CPUs to take?  What happens if you
run on a computer cluster and request only part of the CPUs on a
node?</p>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>Pool by default uses one process for each CPU on the node - it
doesn’t know about your cluster’s scheduling system.  It’s
possible that you have permission to use 2 CPUs but it is trying
to use 12.  This is generally a bad situation, and will just
slow you down (and make other users on the same node upset)!</p>
<p>You either need to be able to specify the number of CPUs to use
(and pass it the right number), or make it aware of the cluster
system.  For example, on a Slurm cluster you would check the
environment variable <code class="docutils literal notranslate"><span class="pre">SLURM_CPUS_PER_TASK</span></code>.</p>
<p>Whatever you do, document what your code is doing under the
hood, so that other users know what is going on (we’ve learned
this from experience…).</p>
</div>
</div>
<p><a class="reference external" href="../parallel/#exercise-2">In parallel.rst:</a></p>
<div class="admonition-parallel-3-mpi exercise important admonition" id="exercise-2">
<p class="admonition-title">Parallel-3, MPI</p>
<p>We can do this as <strong>exercise or as demo</strong>. Note that this example requires <code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> and a
MPI installation such as for instance <a class="reference external" href="https://www.open-mpi.org/">OpenMPI</a>.</p>
<ul class="simple">
<li><p>Try to run this example on one core: <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">example.py</span></code>.</p></li>
<li><p>Then compare the output with a run on multiple cores (in this case 2): <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">mpiexec</span> <span class="pre">-n</span> <span class="pre">2</span> <span class="pre">python</span> <span class="pre">example.py</span></code>.</p></li>
<li><p>Can you guess what the <code class="docutils literal notranslate"><span class="pre">comm.gather</span></code> function does by looking at the print-outs right before and after.</p></li>
<li><p>Why do we have the if-statement <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">rank</span> <span class="pre">==</span> <span class="pre">0</span></code> at the end?</p></li>
<li><p>Why did we use <code class="docutils literal notranslate"><span class="pre">_,</span> <span class="pre">n_inside_circle</span> <span class="pre">=</span> <span class="pre">sample(n_task)</span></code> and not <code class="docutils literal notranslate"><span class="pre">n,</span> <span class="pre">n_inside_circle</span> <span class="pre">=</span> <span class="pre">sample(n_task)</span></code>?</p></li>
</ul>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>We first run the example normally, and get:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>example.py
<span class="go">before gather: rank 0, n_inside_circle: 7854305</span>
<span class="go">after gather: rank 0, n_inside_circle: [7854305]</span>

<span class="go">number of darts: 10000000, estimate: 3.141722, time spent: 2.5 seconds</span>
</pre></div>
</div>
<p>Next we take advantage of the MPI parallelisation and run on 2 cores:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>python<span class="w"> </span>mpi_test.py
<span class="go">before gather: rank 0, n_inside_circle: 3926634</span>
<span class="go">before gather: rank 1, n_inside_circle: 3925910</span>
<span class="go">after gather: rank 1, n_inside_circle: None</span>
<span class="go">after gather: rank 0, n_inside_circle: [3926634, 3925910]</span>

<span class="go">number of darts: 10000000, estimate: 3.1410176, time spent: 1.3 seconds</span>
</pre></div>
</div>
<p>Note that two MPI processes are now printing output. Also, the parallel
version runs twice as fast!</p>
<p>The <code class="docutils literal notranslate"><span class="pre">comm.gather</span></code> function collects (gathers) values of a
given variable from all MPI ranks onto one <cite>root</cite> rank, which is
conventionally rank 0.</p>
<p>A conditional <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">rank</span> <span class="pre">==</span> <span class="pre">0</span></code> is typically used to print output
(or write data to file, etc) from only one rank.</p>
<p>An underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> is often used as a variable name in cases
where the data is unimportant and will not be reused.</p>
</div>
</div>
<p><a class="reference external" href="../parallel/#exercise-3">In parallel.rst:</a></p>
<div class="admonition-dask-examples-optional exercise important admonition" id="exercise-3">
<p class="admonition-title">Dask-Examples (optional)</p>
<p><a class="reference external" href="https://github.com/dask/dask-examples">Dask examples</a> illustrate the usage of dask and can be run interactively through <a class="reference external" href="https://mybinder.org/">mybinder</a>. Start an <a class="reference external" href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab">interactive session on mybinder</a> and test/run a few dask examples.</p>
</div>
</section>
<section id="packaging">
<h3>Packaging<a class="headerlink" href="#packaging" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../packaging/#exercise-0">In packaging.rst:</a></p>
<div class="admonition-packaging-1 exercise important admonition" id="exercise-0">
<p class="admonition-title">Packaging-1</p>
<p>To test a local pip install:</p>
<ul class="simple">
<li><p>Create a new folder outside of our example project</p></li>
<li><p>Create a new virtual environment and activate it (more on this in <a class="reference internal" href="../dependencies/#dependency-management"><span class="std std-ref">Dependency management</span></a>)</p></li>
</ul>
<div class="dropdown admonition hint">
<p class="admonition-title">Hint</p>
<p>To create and activate a virtual environment</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Unix/macOS</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate
which<span class="w"> </span>python
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>python -m venv .venv
.venv\Scripts\activate
where python
</pre></div>
</div>
</div></div>
</div>
<ul>
<li><p>Install the example package from the project folder
into the new environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install --editable /path/to/project-folder/</span>
</pre></div>
</div>
</li>
<li><p>Test the local installation:</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">from calculator import add, subtract, integral</span>

<span class="go">print(&quot;2 + 3 =&quot;, add(2, 3))</span>
<span class="go">print(&quot;2 - 3 =&quot;, subtract(2, 3))</span>
<span class="go">integral_x_squared, error = integral(lambda x: x * x, 0.0, 1.0)</span>
<span class="go">print(f&quot;{integral_x_squared = }&quot;)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Make a change in the <code class="docutils literal notranslate"><span class="pre">subtract</span></code> function above such that it always
returns a float <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">float(x</span> <span class="pre">-</span> <span class="pre">y)</span></code>.</p></li>
<li><p>Open a new Python console and test the following lines. Compare it with
the previous output.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">from calculator import subtract</span>

<span class="go">print(&quot;2 - 3 =&quot;, subtract(2, 3))</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../packaging/#solution-0">In packaging.rst:</a></p>
<div class="admonition-the-long-version-for-finding-the-create-api-token-page solution important dropdown admonition" id="solution-0">
<p class="admonition-title">The long-version for finding the <em>Create API token</em> page</p>
<ol class="arabic simple">
<li><p>Log on to <a class="reference external" href="https://test.pypi.org/">test-PyPI</a> at <a class="reference external" href="https://test.pypi.org">https://test.pypi.org</a></p></li>
<li><p>In the top-right corner, click on the drop-down menu and click <strong>Account settings</strong> or
follow this <a class="reference external" href="https://test.pypi.org/manage/account/#api-tokens">link</a>.</p></li>
<li><p>Scroll down to the section <strong>API tokens</strong> and click the button <strong>Add API token</strong>,
which opens up the
<a class="reference external" href="https://test.pypi.org/manage/account/token/">Create API token</a> page.</p></li>
</ol>
</div>
</section>
<section id="web-apis-with-python">
<h3>Web APIs with Python<a class="headerlink" href="#web-apis-with-python" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../web-apis/#exercise-0">In web-apis.ipynb:</a></p>
<div class="admonition-exercise-webapis-1-request-different-activity-suggestions-from-the-bored-api exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise WebAPIs-1: Request different activity suggestions from the Bored API</p>
<p>Go to the <a class="reference external" href="https://www.boredapi.com/documentation">documentation page of the Bored API</a>. The Bored API is an open API which can be used to randomly generate activity suggestions.</p>
<p>Let’s examine the first sample query on the page http://www.boredapi.com/api/activity/ with a sample JSON response</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;activity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Learn Express.js&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;accessibility&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;education&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;participants&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;link&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://expressjs.com/&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3943506&quot;</span>
<span class="p">}</span><span class="w"> </span>
</pre></div>
</div>
<p>Let’s replicate the query and see if we can get another random suggestion.</p>
</div>
<p><a class="reference external" href="../web-apis/#exercise-1">In web-apis.ipynb:</a></p>
<div class="admonition-exercise-webapis-2-examine-request-and-response-headers exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise WebAPIs-2: Examine request and response headers</p>
<p>Request <a class="reference external" href="https://requests.readthedocs.io/en/latest/user/quickstart/#response-headers">headers</a> are similar to request parameters but usually define meta information regarding, e.g., content encoding (gzip, utf-8) or user identification (user-agent/user ID/etc., password/access token/etc.).</p>
<p>Let’s first make a request.</p>
</div>
<p><a class="reference external" href="../web-apis/#exercise-2">In web-apis.ipynb:</a></p>
<div class="admonition-exercise-webapis-3-scrape-links-from-a-webpage-advanced exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise WebAPIs-3: Scrape links from a webpage (Advanced)</p>
<p>Let’s use <em>Requests</em> to get the HTML source code of www.example.com, examine it, and use the <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">Beautiful Soup</a> library to extract links from it.  <strong>Note:</strong> This requires the extra <code class="docutils literal notranslate"><span class="pre">bs4</span></code> Python package to be installed, which was not in our initial requirements.  Consider this a demo.</p>
</div>
</section>
<section id="extending-python-with-cython">
<h3>Extending Python with Cython<a class="headerlink" href="#extending-python-with-cython" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../cython/#solution-0">In cython.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<img alt="../_images/jupyter-cython-annotate.png" src="../_images/jupyter-cython-annotate.png" />
</div>
</section>
<section id="in-depth-analysis-of-some-selected-file-formats">
<h3>In depth analysis of some selected file formats<a class="headerlink" href="#in-depth-analysis-of-some-selected-file-formats" title="Link to this heading"></a></h3>
<p><a class="reference external" href="../data-formats/#exercise-0">In data-formats.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<ul>
<li><p>Create an arbitrary python object (for example, a string or a list). Pickle it.</p>
<p>Read the pickled object back in and check if it matches the original one.</p>
</li>
</ul>
</div>
<p><a class="reference external" href="../data-formats/#solution-0">In data-formats.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="n">my_object</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;string.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;string.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">my_pickled_object</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">my_object</span><span class="p">,</span> <span class="n">my_pickled_object</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_object</span> <span class="o">==</span> <span class="n">my_pickled_object</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><a class="reference external" href="../data-formats/#exercise-1">In data-formats.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<ul>
<li><p>Create the example <code class="docutils literal notranslate"><span class="pre">dataset</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;20130101&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">),</span>
        <span class="s1">&#39;integer&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
        <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Save the dataset <code class="docutils literal notranslate"><span class="pre">dataset</span></code> as CSV. Load the dataset into a variable <code class="docutils literal notranslate"><span class="pre">dataset_csv</span></code>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">dataset.compare(dataset_csv)</span></code> to check if loaded dataset matches the original one.</p></li>
</ul>
</div>
<p><a class="reference external" href="../data-formats/#solution-1">In data-formats.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;20130101&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">),</span>
        <span class="s1">&#39;integer&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
        <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_rows</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;dataset.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dataset_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">dataset_csv</span><span class="p">))</span>
</pre></div>
</div>
<p>Dataset might not be completely the same. Sometimes the CSV format cannot
fully represent a floating point value, which will result in rounding errors.</p>
</div>
<p><a class="reference external" href="../data-formats/#exercise-2">In data-formats.rst:</a></p>
<div class="admonition-exercise exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise</p>
<ul>
<li><p>Create an example numpy array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">data_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>Store the array as a npy.</p></li>
<li><p>Read the dataframe back in and compare it to the original one. Does the data match?</p></li>
</ul>
</div>
<p><a class="reference external" href="../data-formats/#solution-2">In data-formats.rst:</a></p>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">data_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data_array.npy&#39;</span><span class="p">,</span> <span class="n">data_array</span><span class="p">)</span>
<span class="n">data_array_npy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_array.npy&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">data_array</span> <span class="o">==</span> <span class="n">data_array_npy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../quick-reference/" class="btn btn-neutral float-left" title="Quick reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../guide/" class="btn btn-neutral float-right" title="Instructor’s guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2024, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>